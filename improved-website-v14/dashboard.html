<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AHELP - Arkansas Healthy Employee Lifestyle Program</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
/*
 * Colour palette adjustments for a modern, minimalist AHELP UI.
 * Instead of heavy gradients we use lighter tints of the brand colours.
 */
/* Background gradient for hero/login screens – very subtle tint */
.gradient-bg { background: linear-gradient(135deg, #f8f4fc 0%, #fff5ec 100%); }
/* Generic card backgrounds */
.gradient-card { background: linear-gradient(135deg, #f8eafd 0%, #feeae9 100%); }
/* Success and warning gradients – soft pastel versions */
.gradient-success { background: linear-gradient(135deg, #eac4f9 0%, #fbe9d1 100%); }
.gradient-warning { background: linear-gradient(135deg, #ffeccc 0%, #ffd9d9 100%); }
        
        .card-hover { 
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        }
        .card-hover:hover { 
            transform: translateY(-8px) scale(1.02); 
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.15); 
        }
        
        .progress-bar { 
            transition: width 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94); 
        }
        
/* The pulse glow is toned down for a softer, more refined effect */
.pulse-glow { 
    animation: pulseGlow 3s infinite; 
}
/* Adjust the pulsing glow to match the lighter AHELP palette. We tone down the shadow
   and reduce intensity to avoid visual fatigue on a minimalist design. */
@keyframes pulseGlow {
    0%, 100% { 
        opacity: 1; 
        box-shadow: 0 0 10px rgba(178, 129, 199, 0.4); 
    }
    50% { 
        opacity: 0.85; 
        box-shadow: 0 0 15px rgba(178, 129, 199, 0.6); 
    }
}
        
        .float-animation {
            animation: float 6s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .slide-in {
            animation: slideIn 0.6s ease-out forwards;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .bounce-in {
            animation: bounceIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
        }
        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.3); }
            50% { opacity: 1; transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        .streak-fire {
            animation: streakFire 1.5s ease-in-out infinite;
        }
        @keyframes streakFire {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(-5deg); }
            75% { transform: scale(1.1) rotate(5deg); }
        }
        
        .achievement-unlock {
            animation: achievementUnlock 1s ease-out forwards;
        }
        @keyframes achievementUnlock {
            0% { transform: scale(0) rotate(180deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(0deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
/* Neon glow is simplified for a more subtle accent on action buttons */
.neon-glow {
    box-shadow: 0 0 10px rgba(236, 150, 88, 0.4);
    animation: neonPulse 3s ease-in-out infinite alternate;
}
@keyframes neonPulse {
    from { box-shadow: 0 0 10px rgba(236, 150, 88, 0.4); }
    to   { box-shadow: 0 0 14px rgba(236, 150, 88, 0.6); }
}
        
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #fbbf24;
            border-radius: 50%;
            animation: particle 3s linear infinite;
        }
        @keyframes particle {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
        
        .typing-animation {
            overflow: hidden;
            /* Match the caret colour to the purple brand colour */
            border-right: 2px solid #8e44ad;
            white-space: nowrap;
            animation: typing 3s steps(40, end), blink-caret 0.75s step-end infinite;
        }
        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }
        @keyframes blink-caret {
            from, to { border-color: transparent; }
            /* Use the purple brand colour for the caret blink */
            50% { border-color: #8e44ad; }
        }
        
/* Weather widget uses a soft neutral background; specific weather colour can be added inline */
.weather-widget {
    background: linear-gradient(135deg, #f5f7fa 0%, #eaeff5 100%);
}
        
/* Mood tracker transitions from pale pink to pale lavender to keep the panel light */
.mood-tracker {
    background: linear-gradient(135deg, #fce1ef 0%, #f3d5ee 100%);
}
        
        .water-wave {
            animation: wave 2s ease-in-out infinite;
        }
        @keyframes wave {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f59e0b;
            animation: confetti 3s ease-out forwards;
            z-index: 1000;
        }
        @keyframes confetti {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            transition: stroke-dashoffset 0.5s ease-in-out;
        }
        
        .dark-mode {
            background: #0f172a;
            color: #e2e8f0;
        }
        
        .dark-mode .bg-white {
            background: #1e293b !important;
            color: #e2e8f0 !important;
        }
        
        .dark-mode .text-gray-900 {
            color: #e2e8f0 !important;
        }
        
        .dark-mode .text-gray-600 {
            color: #94a3b8 !important;
        }
        
        .dark-mode .border-gray-300 {
            border-color: #475569 !important;
        }
        
        .voice-command {
            animation: voicePulse 1.5s ease-in-out infinite;
        }
        @keyframes voicePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .notification {
            animation: slideInRight 0.5s ease-out forwards;
        }
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .notification.hide {
            animation: slideOutRight 0.5s ease-in forwards;
        }
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        .sparkle {
            animation: sparkle 1.5s ease-in-out infinite;
        }
        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        .level-up {
            animation: levelUp 2s ease-out forwards;
        }
        @keyframes levelUp {
            0% { transform: scale(0.5) rotate(-180deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(0deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
    </style>
</head>
<body class="bg-purple-100 transition-all duration-500">
    <!-- Particle Background -->
    <div id="particles" class="fixed inset-0 pointer-events-none z-0"></div>
    
    <!-- Login Screen -->
    <div id="login-screen" class="hidden min-h-screen gradient-bg flex items-center justify-center p-4 relative overflow-hidden">
        <!-- Floating Elements removed for a cleaner, minimalist login screen -->
        
        <div class="bg-white rounded-3xl shadow-2xl p-8 w-full max-w-md glass-effect backdrop-blur-lg bounce-in">
            <div class="text-center mb-8">
                <!-- Replace running icon with our logo -->
                <!-- Make the logo even larger on the login screen for greater brand emphasis -->
               <img src="Help (6).png" alt="AHELP logo" class="h-28 w-auto">
                <h1 class="text-3xl font-bold text-gray-900 mb-2 typing-animation">AHELP</h1>
                <p class="text-gray-600 slide-in">Arkansas Healthy Employee Lifestyle Program</p>
            </div>
            
            <div class="mb-6">
                <div class="flex bg-gray-100 rounded-xl p-1 mb-6">
                    <button id="login-tab" class="flex-1 py-3 px-4 rounded-lg bg-white shadow-lg font-medium text-gray-900 transition-all duration-300">Login</button>
                    <button id="signup-tab" class="flex-1 py-3 px-4 rounded-lg font-medium text-gray-600 hover:text-gray-900 transition-all duration-300">Sign Up</button>
                </div>
                
                <!-- Login Form -->
                <form id="login-form" class="space-y-4">
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" required class="w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300" placeholder="your@email.com">
                        <div class="absolute right-3 top-11 text-gray-400">📧</div>
                    </div>
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" required class="w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300" placeholder="••••••••">
                        <div class="absolute right-3 top-11 text-gray-400">🔒</div>
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-purple-400 to-orange-300 text-white py-4 px-4 rounded-xl font-semibold text-lg shadow-lg hover:from-purple-500 hover:to-orange-400 transition-all duration-300 transform hover:scale-105">
                        Sign In & Start Journey
                    </button>
                </form>
                
                <!-- Signup Form -->
                <form id="signup-form" class="space-y-4 hidden">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="relative">
                            <label class="block text-sm font-medium text-gray-700 mb-2">First Name</label>
                            <input type="text" required class="w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300" placeholder="John">
                        </div>
                        <div class="relative">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Last Name</label>
                            <input type="text" required class="w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300" placeholder="Doe">
                        </div>
                    </div>
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" required class="w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300" placeholder="your@email.com">
                        <div class="absolute right-3 top-11 text-gray-400">📧</div>
                    </div>
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" required class="w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300" placeholder="••••••••">
                        <div class="absolute right-3 top-11 text-gray-400">🔒</div>
                    </div>

                    <!-- Health Risk Assessment -->
                    <div class="border-t pt-4 mt-4 space-y-2">
                        <h4 class="text-lg font-semibold text-gray-900 mb-2">Health Risk Assessment</h4>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="relative">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Age</label>
                                <input type="number" min="0" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all" placeholder="Your age">
                            </div>
                            <div class="relative">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Gender</label>
                                <select class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                                    <option value="" disabled selected>Select</option>
                                    <option value="female">Female</option>
                                    <option value="male">Male</option>
                                    <option value="other">Other</option>
                                    <option value="na">Prefer not to say</option>
                                </select>
                            </div>
                            <div class="relative">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Height (cm)</label>
                                <input type="number" min="0" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all" placeholder="e.g. 170">
                            </div>
                            <div class="relative">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Weight (kg)</label>
                                <input type="number" min="0" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all" placeholder="e.g. 70">
                            </div>
                            <div class="relative">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Do you smoke?</label>
                                <select class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                                    <option value="no">No</option>
                                    <option value="yes">Yes</option>
                                </select>
                            </div>
                            <div class="relative">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Existing Conditions</label>
                                <textarea rows="2" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all" placeholder="Describe any conditions"></textarea>
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-pink-300 to-orange-300 text-white py-4 px-4 rounded-xl font-semibold text-lg shadow-lg hover:from-pink-400 hover:to-orange-400 transition-all duration-300 transform hover:scale-105">
                        Create Account & Begin
                    </button>
                </form>
            </div>
            
            <div class="text-center text-sm text-gray-600">
                <p class="bg-orange-50 border border-orange-200 rounded-xl p-4 glass-effect">
                    <strong>🚀 Demo Mode:</strong> Enter any credentials to explore the full wellness experience
                </p>
            </div>
        </div>


    </div>

    <!-- Main Dashboard -->
    <div id="dashboard" class="min-h-screen bg-gray-50 transition-all duration-500">
        <!-- Enhanced Navigation -->
        <!-- Navigation bar -->
        <!-- Simplified Navigation consistent with other pages -->
        <nav class="bg-white shadow-md sticky top-0 z-50 py-4">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between">
                <!-- Branding -->
                <div class="flex items-center space-x-2">
                    <img src="Help (6).png" alt="AHELP logo" class="h-28 w-auto">
                <!-- Navigation links -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="home.html" class="text-1xl font-extrabold bg-gradient-to-r from-purple-400 to-orange-300 bg-clip-text text-transparent">Home</a>
                    <a href="health-assessment.html" class="text-1xl font-extrabold bg-gradient-to-r from-purple-400 to-orange-300 bg-clip-text text-transparent">Assessment</a>
                    <a href="dashboard.html" class="text-purple-600 font-semibold">Dashboard</a>
                    <a href="progress.html" class="text-1xl font-extrabold bg-gradient-to-r from-purple-400 to-orange-300 bg-clip-text text-transparent">Progress</a>
                    <a href="challenges.html" class="text-1xl font-extrabold bg-gradient-to-r from-purple-400 to-orange-300 bg-clip-text text-transparent">Challenges</a>
                    <a href="community.html" class="text-1xl font-extrabold bg-gradient-to-r from-purple-400 to-orange-300 bg-clip-text text-transparent">Community</a>
                    <a href="resources.html" class="text-1xl font-extrabold bg-gradient-to-r from-purple-400 to-orange-300 bg-clip-text text-transparent">Resources</a>
                    <a href="profile.html" class="text-1xl font-extrabold bg-gradient-to-r from-purple-400 to-orange-300 bg-clip-text text-transparent">Profile</a>
                    <a href="settings.html" class="text-1xl font-extrabold bg-gradient-to-r from-purple-400 to-orange-300 bg-clip-text text-transparent">Settings</a>
                    <a href="redeem.html" class="text-1xl font-extrabold bg-gradient-to-r from-purple-400 to-orange-300 bg-clip-text text-transparent">Redeem</a>
                </div>
                <!-- Mobile menu toggle button -->
                <button id="mobile-menu-button" class="md:hidden text-gray-700 focus:outline-none">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
            <!-- Mobile navigation drawer -->
            <div id="mobile-menu" class="md:hidden hidden px-4 pb-4">
                <a href="home.html" class="block py-2 text-gray-700 hover:text-purple-600">Home</a>
                <a href="health-assessment.html" class="block py-2 text-gray-700 hover:text-purple-600">Assessment</a>
                <a href="dashboard.html" class="block py-2 text-purple-600 font-semibold">Dashboard</a>
                <a href="progress.html" class="block py-2 text-gray-700 hover:text-purple-600">Progress</a>
                <a href="challenges.html" class="block py-2 text-gray-700 hover:text-purple-600">Challenges</a>
                <a href="community.html" class="block py-2 text-gray-700 hover:text-purple-600">Community</a>
                <a href="resources.html" class="block py-2 text-gray-700 hover:text-purple-600">Resources</a>
                <a href="profile.html" class="block py-2 text-gray-700 hover:text-purple-600">Profile</a>
                <a href="settings.html" class="block py-2 text-gray-700 hover:text-purple-600">Settings</a>
                <a href="redeem.html" class="block py-2 text-gray-700 hover:text-purple-600">Redeem</a>
            </div>
        </nav>

        <!-- Info bar containing actions and user info -->
        <div id="info-bar" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex flex-col sm:flex-row justify-between items-center space-y-3 sm:space-y-0 sm:space-x-6">
            <!-- Left side: toggles and widgets -->
            <div class="flex items-center space-x-4">
                <!-- Dark Mode Toggle -->
                <button id="dark-mode-toggle" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-gray-700 dark:text-gray-200" aria-label="Toggle dark mode">
                    <svg id="icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" /></svg>
                    <svg id="icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-6 h-6 hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" /></svg>
                </button>
                <!-- Voice Command -->
                <button id="voice-command" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-gray-700 dark:text-gray-200" aria-label="Voice command">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z" /></svg>
                </button>
                <!-- Weather Widget -->
                <div class="weather-widget text-gray-700 dark:text-gray-200 px-4 py-2 rounded-full flex items-center space-x-1 text-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-5 h-5 text-yellow-400"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" /></svg>
                    <span>72°F</span>
                </div>
            </div>
            <!-- Right side: points and user info -->
            <div class="flex items-center space-x-4">
                <!-- Points Display -->
                <div class="flex items-center space-x-2 bg-gradient-to-r from-yellow-300 to-orange-300 px-5 py-3 rounded-full pulse-glow">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-5 h-5 text-white"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" /></svg>
                    <span id="total-points" class="font-bold text-white text-sm">0 Points</span>
                </div>
                <!-- Welcome message -->
                <div class="text-gray-700 dark:text-gray-200">Welcome, <span id="user-name" class="font-semibold bg-gradient-to-r from-purple-400 to-orange-300 bg-clip-text text-transparent">User</span>!</div>
                <!-- Logout -->
                <button id="logout-btn" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-all duration-300 transform hover:scale-110" aria-label="Logout">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Dashboard Content -->
        <div id="dashboard-page" class="page-content max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Display toggles allow users to hide or show individual stats on the dashboard -->
            <div class="flex flex-wrap items-center gap-4 mb-4">
                <label class="flex items-center space-x-2 text-sm font-medium text-gray-700">
                    <input type="checkbox" id="toggle-cardio" class="form-checkbox h-4 w-4 text-purple-500" checked>
                    <span>Cardio</span>
                </label>
                <label class="flex items-center space-x-2 text-sm font-medium text-gray-700">
                    <input type="checkbox" id="toggle-nutrition" class="form-checkbox h-4 w-4 text-orange-500" checked>
                    <span>Nutrition</span>
                </label>
                <label class="flex items-center space-x-2 text-sm font-medium text-gray-700">
                    <input type="checkbox" id="toggle-tobacco" class="form-checkbox h-4 w-4 text-pink-500" checked>
                    <span>Tobacco Free</span>
                </label>
                <label class="flex items-center space-x-2 text-sm font-medium text-gray-700">
                    <input type="checkbox" id="toggle-points" class="form-checkbox h-4 w-4 text-orange-500" checked>
                    <span>Points</span>
                </label>
            </div>
            <!-- Enhanced Stats Overview -->
            <div class="grid md:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover relative overflow-hidden" data-stat="cardio">
                    <!-- Use a purple accent for the cardio card -->
                    <div class="absolute top-0 right-0 w-20 h-20 bg-purple-100 rounded-full -mr-10 -mt-10"></div>
                    <!-- Replace emoji with a bolt icon to represent cardio activity -->
                    <div class="mb-3">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-8 h-8 mx-auto text-purple-600">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
                        </svg>
                    </div>
                    <!-- Update text colour to purple to align with brand -->
                    <div class="text-3xl font-bold text-purple-600 mb-1" id="cardio-streak">0</div>
                    <div class="text-gray-600 font-medium">Day Cardio Streak</div>
                    <div class="mt-3">
                        <svg class="progress-ring w-16 h-16 mx-auto" width="64" height="64">
                            <!-- Purple ring background and progress indicator -->
                            <circle class="progress-ring-circle stroke-purple-200" stroke-width="4" fill="transparent" r="28" cx="32" cy="32"/>
                            <circle class="progress-ring-circle stroke-purple-400" stroke-width="4" fill="transparent" r="28" cx="32" cy="32" stroke-dasharray="175.93" stroke-dashoffset="175.93" id="cardio-ring"/>
                        </svg>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover relative overflow-hidden" data-stat="nutrition">
                    <!-- Use an orange accent for the nutrition card -->
                    <div class="absolute top-0 right-0 w-20 h-20 bg-orange-100 rounded-full -mr-10 -mt-10"></div>
                    <!-- Replace emoji with a cake icon to represent nutrition goals -->
                    <div class="mb-3">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-8 h-8 mx-auto text-orange-600">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 8.25v-1.5m0 1.5c-1.355 0-2.697.056-4.024.166C6.845 8.51 6 9.473 6 10.608v2.513m6-4.87c1.355 0 2.697.055 4.024.165C17.155 8.51 18 9.473 18 10.608v2.513m-3-4.87v-1.5m-6 1.5v-1.5m12 9.75l-1.5.75a3.354 3.354 0 01-3 0 3.354 3.354 0 00-3 0 3.354 3.354 0 01-3 0 3.354 3.354 0 00-3 0 3.354 3.354 0 01-3 0L3 16.5m15-3.38a48.474 48.474 0 00-6-.37c-2.032 0-4.034.125-6 .37m12 0c.39.049.777.102 1.163.16 1.07.16 1.837 1.094 1.837 2.175v5.17c0 .62-.504 1.124-1.125 1.124H4.125A1.125 1.125 0 013 20.625v-5.17c0-1.08.768-2.014 1.837-2.174A47.78 47.78 0 016 13.12M12.265 3.11a.375.375 0 11-.53 0L12 2.845l.265.265zm-3 0a.375.375 0 11-.53 0L9 2.845l.265.265zm6 0a.375.375 0 11-.53 0L15 2.845l.265.265z" />
                        </svg>
                    </div>
                    <!-- Update text colour to orange to align with nutrition accent -->
                    <div class="text-3xl font-bold text-orange-600 mb-1" id="nutrition-streak">0</div>
                    <div class="text-gray-600 font-medium">Day Nutrition Streak</div>
                    <div class="mt-3">
                        <svg class="progress-ring w-16 h-16 mx-auto" width="64" height="64">
                            <!-- Orange ring background and progress indicator -->
                            <circle class="progress-ring-circle stroke-orange-200" stroke-width="4" fill="transparent" r="28" cx="32" cy="32"/>
                            <circle class="progress-ring-circle stroke-orange-400" stroke-width="4" fill="transparent" r="28" cx="32" cy="32" stroke-dasharray="175.93" stroke-dashoffset="175.93" id="nutrition-ring"/>
                        </svg>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover relative overflow-hidden" data-stat="tobacco">
                    <!-- Use a pink accent for the tobacco card -->
                    <div class="absolute top-0 right-0 w-20 h-20 bg-pink-100 rounded-full -mr-10 -mt-10"></div>
                    <!-- Replace emoji with a no-symbol icon to represent tobacco free -->
                    <div class="mb-3">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-8 h-8 mx-auto text-pink-600">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
                        </svg>
                    </div>
                    <!-- Update text colour to pink to differentiate from other stats -->
                    <div class="text-3xl font-bold text-pink-600 mb-1" id="tobacco-streak">0</div>
                    <div class="text-gray-600 font-medium">Days Tobacco Free</div>
                    <div class="mt-3">
                        <svg class="progress-ring w-16 h-16 mx-auto" width="64" height="64">
                            <!-- Pink ring background and progress indicator -->
                            <circle class="progress-ring-circle stroke-pink-200" stroke-width="4" fill="transparent" r="28" cx="32" cy="32"/>
                            <circle class="progress-ring-circle stroke-pink-400" stroke-width="4" fill="transparent" r="28" cx="32" cy="32" stroke-dasharray="175.93" stroke-dashoffset="175.93" id="tobacco-ring"/>
                        </svg>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover relative overflow-hidden" data-stat="points">
                    <!-- Use an orange accent for the points card to tie into the logo colours -->
                    <div class="absolute top-0 right-0 w-20 h-20 bg-orange-100 rounded-full -mr-10 -mt-10"></div>
                    <!-- Replace star emoji with a star icon to represent points -->
                    <div class="mb-3">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-8 h-8 mx-auto text-orange-600">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
                        </svg>
                    </div>
                    <div class="text-3xl font-bold text-orange-600 mb-1" id="weekly-points">0</div>
                    <div class="text-gray-600 font-medium">Points This Week</div>
                    <div class="mt-3">
                        <div class="w-full bg-gray-200 rounded-full h-3">
                        <div id="weekly-progress-bar" class="bg-gradient-to-r from-orange-300 to-pink-300 h-3 rounded-full progress-bar" style="width: 0%"></div>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">Goal: 200 pts</div>
                    </div>
                </div>
            </div>
            <!-- Steps Tracking -->    
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover relative overflow-hidden">
                        <!-- Blue to green gradient for steps -->
                            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-400 to-green-400"></div>
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-xl font-semibold text-gray-900">Steps</h3>
                                <div class="float-animation">
                                    <!-- Footsteps icon -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-7 h-7 text-green-600">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 9.75C6.971 4.365 10.006 2.25 12.75 2.25c1.287 0 2.65.643 3.853 1.848M12.75 2.25c-2.744 0-5.779 2.115-8.25 7.5 2.471 5.385 5.506 7.5 8.25 7.5 1.287 0 2.65-.643 3.853-1.848m0 0C17.029 19.635 13.994 21.75 11.25 21.75c-2.744 0-5.779-2.115-8.25-7.5"></path>
                                    </svg>
                                </div>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Steps Today</label>
                                <input type="number" id="steps-count" min="0" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all duration-300" placeholder="0">
                            </div>
                            <button id="log-steps" class="w-full bg-gradient-to-r from-blue-400 to-green-400 text-white py-4 px-4 rounded-xl font-semibold text-lg shadow-lg hover:from-blue-500 hover:to-green-500 transition-all duration-300 transform hover:scale-105">
                                Log Steps (+5 Points)
                            </button>
                            <div class="mt-4 text-sm text-gray-600">
                                <div class="flex justify-between mb-2">
                                    <span id="steps-progress-text">0 steps logged</span>
                                    <span id="steps-goal-label">Goal: 10000 steps</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div id="steps-progress" class="bg-gradient-to-r from-blue-400 to-green-400 h-3 rounded-full progress-bar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
            <!-- Quick Actions & Mood Tracker -->
            <div class="grid lg:grid-cols-4 gap-6 mb-8">
                <div class="lg:col-span-3">
                    <!-- Enhanced Tracking Cards -->
                    <div class="grid lg:grid-cols-4 gap-6">
                        <!-- Cardio Tracking -->
                        <div class="bg-white rounded-2xl shadow-xl p-6 card-hover relative overflow-hidden">
                            <!-- Purple to orange gradient for cardio -->
                            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-purple-400 to-orange-300"></div>
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-xl font-semibold text-gray-900">Cardio Exercise</h3>
                                <!-- Replace running emoji with bolt icon -->
                                <div class="float-animation">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-7 h-7 text-purple-600">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
                                    </svg>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Minutes Today</label>
                                <div class="relative">
                                    <input type="number" id="cardio-minutes" min="0" max="300" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300" placeholder="0">
                                    <div class="absolute right-3 top-3 text-gray-400">
                                        <!-- Clock icon instead of emoji for time input -->
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-5 h-5">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Activity Type</label>
                                <select id="cardio-type" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300">
                                    <option value="walking">Walking</option>
                                    <option value="running">Running</option>
                                    <option value="cycling">Cycling</option>
                                    <option value="swimming">Swimming</option>
                                    <option value="dancing">Dancing</option>
                                    <option value="yoga">Yoga</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            
                            <button id="log-cardio" class="w-full bg-gradient-to-r from-purple-400 to-orange-300 text-white py-4 px-4 rounded-xl font-semibold text-lg shadow-lg hover:from-purple-500 hover:to-orange-400 transition-all duration-300 transform hover:scale-105 pulse-glow">
                                Log Cardio (+10 Points)
                            </button>
                            
                            <div class="mt-4 text-sm text-gray-600">
                                <div class="flex justify-between mb-2">
                                    <span>Today's Goal: 30 min</span>
                                    <span id="cardio-today">0 min logged</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div id="cardio-progress" class="bg-gradient-to-r from-purple-400 to-orange-300 h-3 rounded-full progress-bar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Nutrition Tracking -->
                        <div class="bg-white rounded-2xl shadow-xl p-6 card-hover relative overflow-hidden">
                            <!-- Orange to pink gradient for nutrition -->
                            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-orange-300 to-pink-300"></div>
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-xl font-semibold text-gray-900">Nutrition Goals</h3>
                                <!-- Replace salad emoji with cake icon -->
                                <div class="float-animation">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-7 h-7 text-orange-600">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 8.25v-1.5m0 1.5c-1.355 0-2.697.056-4.024.166C6.845 8.51 6 9.473 6 10.608v2.513m6-4.87c1.355 0 2.697.055 4.024.165C17.155 8.51 18 9.473 18 10.608v2.513m-3-4.87v-1.5m-6 1.5v-1.5m12 9.75l-1.5.75a3.354 3.354 0 01-3 0 3.354 3.354 0 00-3 0 3.354 3.354 0 01-3 0 3.354 3.354 0 00-3 0 3.354 3.354 0 01-3 0L3 16.5m15-3.38a48.474 48.474 0 00-6-.37c-2.032 0-4.034.125-6 .37m12 0c.39.049.777.102 1.163.16 1.07.16 1.837 1.094 1.837 2.175v5.17c0 .62-.504 1.124-1.125 1.124H4.125A1.125 1.125 0 013 20.625v-5.17c0-1.08.768-2.014 1.837-2.174A47.78 47.78 0 016 13.12M12.265 3.11a.375.375 0 11-.53 0L12 2.845l.265.265zm-3 0a.375.375 0 11-.53 0L9 2.845l.265.265zm6 0a.375.375 0 11-.53 0L15 2.845l.265.265z" />
                                    </svg>
                                </div>
                            </div>
                            
                            <div class="space-y-3 mb-4">
                                <label class="flex items-center p-3 rounded-xl hover:bg-orange-50 transition-colors cursor-pointer">
                                    <input type="checkbox" class="nutrition-check mr-3 h-5 w-5 text-orange-600 rounded focus:ring-orange-500">
                                    <span class="text-gray-700 flex-1">5+ servings fruits/vegetables</span>
                                </label>
                                <label class="flex items-center p-3 rounded-xl hover:bg-pink-50 transition-colors cursor-pointer">
                                    <input type="checkbox" class="nutrition-check mr-3 h-5 w-5 text-orange-600 rounded focus:ring-orange-500">
                                    <span class="text-gray-700 flex-1 water-wave">8+ glasses of water</span>
                                </label>
                                <label class="flex items-center p-3 rounded-xl hover:bg-orange-50 transition-colors cursor-pointer">
                                    <input type="checkbox" class="nutrition-check mr-3 h-5 w-5 text-orange-600 rounded focus:ring-orange-500">
                                    <span class="text-gray-700 flex-1">Avoided processed foods</span>
                                </label>
                                <label class="flex items-center p-3 rounded-xl hover:bg-yellow-50 transition-colors cursor-pointer">
                                    <input type="checkbox" class="nutrition-check mr-3 h-5 w-5 text-orange-600 rounded focus:ring-orange-500">
                                    <span class="text-gray-700 flex-1">Healthy breakfast</span>
                                </label>
                            </div>
                            
                            <button id="log-nutrition" class="w-full bg-gradient-to-r from-orange-400 to-pink-300 text-white py-4 px-4 rounded-xl font-semibold text-lg shadow-lg hover:from-orange-500 hover:to-pink-400 transition-all duration-300 transform hover:scale-105 neon-glow">
                                Log Nutrition (+15 Points)
                            </button>
                            
                            <div class="mt-4 text-sm text-gray-600">
                                <div class="flex justify-between mb-2">
                                    <span>Goals completed:</span>
                                    <span id="nutrition-progress-text">0/4</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div id="nutrition-progress" class="bg-gradient-to-r from-orange-300 to-pink-300 h-3 rounded-full progress-bar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Tobacco Free Tracking -->
                        <div class="bg-white rounded-2xl shadow-xl p-6 card-hover relative overflow-hidden">
                            <!-- Pink to orange gradient for tobacco free -->
                            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-pink-300 to-orange-300"></div>
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-xl font-semibold text-gray-900">Tobacco Free</h3>
                                <!-- Replace no-smoking emoji with no-symbol icon -->
                                <div class="float-animation">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-7 h-7 text-pink-600">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
                                    </svg>
                                </div>
                            </div>
                            
                            <div class="text-center mb-6">
                                <div class="text-5xl font-bold text-pink-600 mb-2" id="tobacco-days">0</div>
                                <div class="text-gray-600 font-medium">Days tobacco free</div>
                                <div class="text-xs text-gray-500 mt-1">Keep going strong!</div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="flex items-center justify-center p-4 rounded-xl border-2 border-dashed border-pink-300 hover:border-pink-500 hover:bg-pink-50 transition-all cursor-pointer">
                                    <input type="checkbox" id="tobacco-free-today" class="mr-3 h-6 w-6 text-pink-600 rounded focus:ring-pink-500">
                                    <span class="text-gray-700 font-medium">I stayed tobacco-free today</span>
                                </label>
                            </div>
                            
                            <button id="log-tobacco" class="w-full bg-gradient-to-r from-pink-400 to-orange-300 text-white py-4 px-4 rounded-xl font-semibold text-lg shadow-lg hover:from-pink-500 hover:to-orange-400 transition-all duration-300 transform hover:scale-105">
                                Confirm Day (+20 Points)
                            </button>
                            
                            <div class="mt-4 p-4 bg-gradient-to-r from-pink-50 to-orange-50 rounded-xl">
                                <div class="text-sm text-pink-700 text-center">
                                    <div class="font-semibold mb-1">Health Benefits:</div>
                                    <div id="health-benefit" class="text-xs">Every day counts towards better health!</div>
                                </div>
                            </div>
                        </div>

                        <!-- Hydration Tracking -->
                        <div class="bg-white rounded-2xl shadow-xl p-6 card-hover relative overflow-hidden">
                            <!-- Blue gradient for hydration -->
                            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-300 to-blue-500"></div>
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-xl font-semibold text-gray-900">Hydration</h3>
                                <div class="float-animation">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-7 h-7 text-blue-600">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 2.25c3.556 5.586 5.333 8.38 5.333 11.417a5.333 5.333 0 11-10.667 0c0-3.037 1.778-5.83 5.334-11.417z" />
                                    </svg>
                                </div>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Glasses Today</label>
                                <div class="relative">
                                    <input type="number" id="water-count-input" min="0" max="20" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300" placeholder="0">
                                    <div class="absolute right-3 top-3 text-gray-400">
                                        <!-- Water drop icon -->
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-5 h-5">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 2.25c3.556 5.586 5.333 8.38 5.333 11.417a5.333 5.333 0 11-10.667 0c0-3.037 1.778-5.83 5.334-11.417z" />
                                        </svg>
                                    </div>
                                </div>
                            </div>
                            <button id="log-water" class="w-full bg-gradient-to-r from-blue-400 to-blue-600 text-white py-4 px-4 rounded-xl font-semibold text-lg shadow-lg hover:from-blue-500 hover:to-blue-700 transition-all duration-300 transform hover:scale-105">
                                Log Water (+5 Points)
                            </button>
                            <div class="mt-4 text-sm text-gray-600">
                                <div class="flex justify-between mb-2">
                                    <!-- Display glasses logged on the left and the goal on the right for clarity -->
                                    <span id="water-today">0 glasses logged</span>
                                    <span>Goal: 8 glasses</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div id="water-progress" class="bg-gradient-to-r from-blue-300 to-blue-500 h-3 rounded-full progress-bar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Mood Tracker -->
                <div class="mood-tracker rounded-2xl shadow-xl p-6 text-white card-hover">
                    <h3 class="text-xl font-semibold mb-4">Mood Tracker</h3>
                    <div class="space-y-3">
                        <button class="mood-btn w-full p-3 rounded-xl bg-white bg-opacity-20 hover:bg-opacity-30 transition-all" data-mood="amazing" aria-label="Select amazing mood">
                            Amazing
                        </button>
                        <button class="mood-btn w-full p-3 rounded-xl bg-white bg-opacity-20 hover:bg-opacity-30 transition-all" data-mood="good" aria-label="Select good mood">
                            Good
                        </button>
                        <button class="mood-btn w-full p-3 rounded-xl bg-white bg-opacity-20 hover:bg-opacity-30 transition-all" data-mood="okay" aria-label="Select okay mood">
                            Okay
                        </button>
                        <button class="mood-btn w-full p-3 rounded-xl bg-white bg-opacity-20 hover:bg-opacity-30 transition-all" data-mood="low" aria-label="Select low mood">
                            Low
                        </button>
                    </div>
                    <div class="mt-4 text-center">
                        <div class="text-sm opacity-80">Today's mood:</div>
                        <!-- Default mood display; will update when user selects a mood -->
                        <div id="current-mood" class="text-2xl mt-1">--</div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Activity & Achievements -->
            <div class="grid lg:grid-cols-2 gap-8 mb-8">
                <!-- Recent Activity with Timeline -->
                <div class="bg-white rounded-2xl shadow-xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900 flex items-center space-x-2">
                            <!-- Chart bar icon for recent activity header -->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-5 h-5 text-purple-600"><path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"/></svg>
                            <span>Recent Activity</span>
                        </h3>
                        <button class="text-purple-600 hover:text-purple-800 text-sm font-medium">View All</button>
                    </div>
                    <div id="activity-log" class="space-y-4">
                        <div class="text-gray-500 text-center py-8 flex flex-col items-center">
                            <div class="text-4xl mb-2">🚀</div>
                            <div>Start tracking to see your amazing journey!</div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Achievements -->
                <div class="bg-white rounded-2xl shadow-xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900 flex items-center space-x-2">
                            <!-- Trophy icon instead of emoji for achievements header -->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-5 h-5 text-purple-600"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 18.75h-9m9 0a3 3 0 013 3h-15a3 3 0 013-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 01-.982-3.172M9.497 14.25a7.454 7.454 0 00.981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 007.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 002.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 012.916.52 6.003 6.003 0 01-5.395 4.972m0 0a6.726 6.726 0 01-2.749 1.35m0 0a6.772 6.772 0 01-3.044 0"/></svg>
                            <span>Achievements</span>
                        </h3>
                        <div class="text-sm text-gray-500">
                            <span id="achievement-count">0</span>/12 unlocked
                        </div>
                    </div>
                    <div id="achievements" class="grid grid-cols-2 gap-4">
                        <div class="achievement-badge opacity-50 text-center p-4 border-2 border-dashed border-gray-300 rounded-xl hover:border-purple-400 transition-all cursor-pointer" data-achievement="first-cardio">
                            <div class="mb-2">
                                <!-- Bolt icon for first cardio achievement -->
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-7 h-7 mx-auto text-purple-600">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
                                </svg>
                            </div>
                            <div class="text-sm font-medium text-gray-600">First Steps</div>
                            <div class="text-xs text-gray-500">Log your first workout</div>
                        </div>
                        <div class="achievement-badge opacity-50 text-center p-4 border-2 border-dashed border-gray-300 rounded-xl hover:border-orange-300 transition-all cursor-pointer" data-achievement="nutrition-master">
                            <div class="mb-2">
                                <!-- Cake icon for nutrition master achievement -->
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-7 h-7 mx-auto text-orange-600">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 8.25v-1.5m0 1.5c-1.355 0-2.697.056-4.024.166C6.845 8.51 6 9.473 6 10.608v2.513m6-4.87c1.355 0 2.697.055 4.024.165C17.155 8.51 18 9.473 18 10.608v2.513m-3-4.87v-1.5m-6 1.5v-1.5m12 9.75l-1.5.75a3.354 3.354 0 01-3 0 3.354 3.354 0 00-3 0 3.354 3.354 0 01-3 0 3.354 3.354 0 00-3 0 3.354 3.354 0 01-3 0L3 16.5m15-3.38a48.474 48.474 0 00-6-.37c-2.032 0-4.034.125-6 .37m12 0c.39.049.777.102 1.163.16 1.07.16 1.837 1.094 1.837 2.175v5.17c0 .62-.504 1.124-1.125 1.124H4.125A1.125 1.125 0 013 20.625v-5.17c0-1.08.768-2.014 1.837-2.174A47.78 47.78 0 016 13.12M12.265 3.11a.375.375 0 11-.53 0L12 2.845l.265.265zm-3 0a.375.375 0 11-.53 0L9 2.845l.265.265zm6 0a.375.375 0 11-.53 0L15 2.845l.265.265z" />
                                </svg>
                            </div>
                            <div class="text-sm font-medium text-gray-600">Nutrition Master</div>
                            <div class="text-xs text-gray-500">Complete all nutrition goals</div>
                        </div>
                        <div class="achievement-badge opacity-50 text-center p-4 border-2 border-dashed border-gray-300 rounded-xl hover:border-pink-300 transition-all cursor-pointer" data-achievement="smoke-free-week">
                            <div class="mb-2">
                                <!-- No symbol icon for smoke free achievement -->
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-7 h-7 mx-auto text-pink-600">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
                                </svg>
                            </div>
                            <div class="text-sm font-medium text-gray-600">Smoke Free Week</div>
                            <div class="text-xs text-gray-500">7 days tobacco free</div>
                        </div>
                        <div class="achievement-badge opacity-50 text-center p-4 border-2 border-dashed border-gray-300 rounded-xl hover:border-orange-300 transition-all cursor-pointer" data-achievement="point-collector">
                            <div class="mb-2">
                                <!-- Star icon for point collector achievement -->
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-7 h-7 mx-auto text-orange-600">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
                                </svg>
                            </div>
                            <div class="text-sm font-medium text-gray-600">Point Collector</div>
                            <div class="text-xs text-gray-500">Earn 100 points</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Daily Insights & Tips -->
            <div class="bg-gradient-to-r from-indigo-300 to-purple-400 rounded-2xl shadow-xl p-8 text-white">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold flex items-center space-x-2">
                        <!-- Light bulb icon instead of emoji for daily insight header -->
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-6 h-6 text-yellow-300"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.383a14.406 14.406 0 01-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 10-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"/></svg>
                        <span>Daily Wellness Insight</span>
                    </h3>
                    <button id="refresh-tip" class="bg-white bg-opacity-20 hover:bg-opacity-30 px-4 py-2 rounded-xl transition-all">
                        New Tip
                    </button>
                </div>
                <div id="daily-tip" class="text-lg opacity-90">
                    "The journey of a thousand miles begins with a single step. Every healthy choice you make today is an investment in your future self."
                </div>
                <div class="mt-4 text-sm opacity-75">
                    💪 Keep pushing forward - you're doing amazing!
                </div>
            </div>
        </div>

            <!-- Annual HRA Reminder: hidden by default; shown when it's been a year since the user last completed the Health Risk Assessment -->
            <div id="hra-reminder" class="hidden mb-6 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-4 rounded-xl">
                <p class="mb-1 font-semibold">It's time to update your Health Risk Assessment.</p>
                <p class="text-sm">It's been over a year since your last assessment. Please <a href="health-assessment.html" class="underline text-purple-600">complete your assessment</a> to refresh your personalised goals.</p>
            </div>

            <!-- Personalized Plan: displays the user’s goals generated from the health assessment -->
            <div id="personalized-plan" class="hidden mb-6 bg-white rounded-2xl shadow-xl p-6 dark-mode:bg-gray-800">
                <h3 class="text-xl font-semibold mb-3 text-gray-900 dark-mode:text-white">Your Personalized Goals</h3>
                <ul id="personalized-goals-list" class="list-disc list-inside space-y-2 text-gray-700 dark-mode:text-gray-300"></ul>
            </div>

        <!-- Other pages remain the same but hidden -->
        <div id="progress-page" class="page-content hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Progress Header -->
            <div class="bg-gradient-to-r from-purple-400 to-orange-300 rounded-2xl shadow-xl p-8 text-white mb-8">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-4xl font-bold mb-2">📊 Progress Analytics</h1>
                        <p class="text-xl opacity-90">Track your incredible wellness transformation</p>
                    </div>
                    <div class="text-right">
                        <div class="text-3xl font-bold mb-1" id="progress-level">Level 1</div>
                        <div class="text-sm opacity-80">Wellness Warrior</div>
                        <div class="w-48 bg-white bg-opacity-20 rounded-full h-3 mt-2">
                            <div id="progress-level-bar" class="bg-white h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Time Period Selector -->
            <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-semibold text-gray-900">📅 Time Period</h3>
                    <div class="flex bg-gray-100 rounded-xl p-1">
                        <button class="period-btn px-4 py-2 rounded-lg bg-purple-600 text-white font-medium transition-all" data-period="7">7 Days</button>
                        <button class="period-btn px-4 py-2 rounded-lg text-gray-600 hover:text-gray-900 font-medium transition-all" data-period="30">30 Days</button>
                        <button class="period-btn px-4 py-2 rounded-lg text-gray-600 hover:text-gray-900 font-medium transition-all" data-period="90">90 Days</button>
                        <button class="period-btn px-4 py-2 rounded-lg text-gray-600 hover:text-gray-900 font-medium transition-all" data-period="365">1 Year</button>
                    </div>
                </div>
            </div>

            <!-- Key Metrics Overview -->
            <div class="grid md:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover">
                    <div class="text-4xl mb-3">🔥</div>
                    <div class="text-3xl font-bold text-orange-600 mb-1" id="total-workouts">0</div>
                    <div class="text-gray-600 font-medium">Total Workouts</div>
                    <div class="text-sm text-orange-600 mt-2">+12% from last period</div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover">
                    <div class="text-4xl mb-3">⏱️</div>
                    <div class="text-3xl font-bold text-purple-600 mb-1" id="total-minutes">0</div>
                    <div class="text-gray-600 font-medium">Minutes Exercised</div>
                    <div class="text-sm text-orange-600 mt-2">+8% from last period</div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover">
                    <div class="text-4xl mb-3">🎯</div>
                    <div class="text-3xl font-bold text-orange-600 mb-1" id="goals-completed">0</div>
                    <div class="text-gray-600 font-medium">Goals Completed</div>
                    <div class="text-sm text-orange-600 mt-2">+15% from last period</div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover">
                    <div class="text-4xl mb-3">📈</div>
                    <div class="text-3xl font-bold text-purple-600 mb-1" id="consistency-score">0%</div>
                    <div class="text-gray-600 font-medium">Consistency Score</div>
                    <div class="text-sm text-orange-600 mt-2">+5% from last period</div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="grid lg:grid-cols-2 gap-8 mb-8">
                <!-- Activity Chart -->
                <div class="bg-white rounded-2xl shadow-xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">📈 Activity Trends</h3>
                        <div class="flex space-x-2">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-purple-600 rounded-full mr-2"></div>
                                <span class="text-sm text-gray-600">Cardio</span>
                            </div>
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-orange-600 rounded-full mr-2"></div>
                                <span class="text-sm text-gray-600">Nutrition</span>
                            </div>
                        </div>
                    </div>
                    <div class="relative h-64">
                        <canvas id="activityChart"></canvas>
                    </div>
                </div>

                <!-- Points Chart -->
                <div class="bg-white rounded-2xl shadow-xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">⭐ Points Progress</h3>
                        <div class="text-sm text-gray-600">Daily average: <span class="font-semibold text-yellow-600">25 pts</span></div>
                    </div>
                    <div class="relative h-64">
                        <canvas id="pointsChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Detailed Breakdowns -->
            <div class="grid lg:grid-cols-3 gap-8 mb-8">
                <!-- Activity Breakdown -->
                <div class="bg-white rounded-2xl shadow-xl p-6">
                    <h3 class="text-xl font-semibold text-gray-900 mb-6">🏃‍♂️ Activity Breakdown</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-purple-50 rounded-xl">
                            <div class="flex items-center">
                                <div class="text-2xl mr-3">🏃‍♂️</div>
                                <div>
                                    <div class="font-semibold text-gray-900">Running</div>
                                    <div class="text-sm text-gray-600">45% of activities</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-purple-600">180 min</div>
                                <div class="text-sm text-gray-500">12 sessions</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between p-4 bg-orange-50 rounded-xl">
                            <div class="flex items-center">
                                <div class="text-2xl mr-3">🚶‍♂️</div>
                                <div>
                                    <div class="font-semibold text-gray-900">Walking</div>
                                    <div class="text-sm text-gray-600">30% of activities</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-orange-600">120 min</div>
                                <div class="text-sm text-gray-500">8 sessions</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between p-4 bg-purple-50 rounded-xl">
                            <div class="flex items-center">
                                <div class="text-2xl mr-3">🧘‍♀️</div>
                                <div>
                                    <div class="font-semibold text-gray-900">Yoga</div>
                                    <div class="text-sm text-gray-600">25% of activities</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-purple-600">90 min</div>
                                <div class="text-sm text-gray-500">6 sessions</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Streak Analysis -->
                <div class="bg-white rounded-2xl shadow-xl p-6">
                    <h3 class="text-xl font-semibold text-gray-900 mb-6">🔥 Streak Analysis</h3>
                    <div class="space-y-6">
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-gray-700">Cardio Streak</span>
                            <span class="font-bold text-purple-600" id="streak-cardio">0 days</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-3">
                                <div class="bg-gradient-to-r from-purple-600 to-orange-500 h-3 rounded-full" style="width: 60%"></div>
                            </div>
                            <div class="text-xs text-gray-500 mt-1">Best: 14 days</div>
                        </div>
                        
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-gray-700">Nutrition Streak</span>
                            <span class="font-bold text-orange-600" id="streak-nutrition">0 days</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-3">
                                <div class="bg-gradient-to-r from-orange-500 to-pink-500 h-3 rounded-full" style="width: 40%"></div>
                            </div>
                            <div class="text-xs text-gray-500 mt-1">Best: 21 days</div>
                        </div>
                        
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-gray-700">Tobacco Free</span>
                            <span class="font-bold text-pink-600" id="streak-tobacco">0 days</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-3">
                                <div class="bg-gradient-to-r from-pink-500 to-orange-500 h-3 rounded-full" style="width: 80%"></div>
                            </div>
                            <div class="text-xs text-gray-500 mt-1">Best: 30 days</div>
                        </div>
                    </div>
                </div>

                <!-- Weekly Goals -->
                <div class="bg-white rounded-2xl shadow-xl p-6">
                    <h3 class="text-xl font-semibold text-gray-900 mb-6">🎯 Weekly Goals</h3>
                    <div class="space-y-4">
                        <div class="p-4 bg-gradient-to-r from-purple-50 to-orange-50 rounded-xl">
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">Cardio Minutes</span>
                                <span class="text-purple-500 font-bold">150/150</span>
                            </div>
                            <div class="w-full bg-white rounded-full h-3">
                                <div class="bg-gradient-to-r from-purple-400 to-orange-300 h-3 rounded-full" style="width: 100%"></div>
                            </div>
                            <div class="text-xs text-orange-600 mt-1 font-semibold">✅ Goal Achieved!</div>
                        </div>
                        
                        <div class="p-4 bg-gradient-to-r from-orange-50 to-pink-50 rounded-xl">
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">Nutrition Days</span>
                                <span class="text-orange-500 font-bold">5/7</span>
                            </div>
                            <div class="w-full bg-white rounded-full h-3">
                                <div class="bg-gradient-to-r from-orange-300 to-pink-300 h-3 rounded-full" style="width: 71%"></div>
                            </div>
                            <div class="text-xs text-orange-600 mt-1 font-semibold">🎯 2 days to go!</div>
                        </div>
                        
                        <div class="p-4 bg-gradient-to-r from-orange-50 to-pink-50 rounded-xl">
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">Points Target</span>
                                <span class="text-orange-500 font-bold">180/200</span>
                            </div>
                            <div class="w-full bg-white rounded-full h-3">
                                <div class="bg-gradient-to-r from-orange-300 to-pink-300 h-3 rounded-full" style="width: 90%"></div>
                            </div>
                            <div class="text-xs text-orange-600 mt-1 font-semibold">🔥 Almost there!</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calendar Heatmap -->
            <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-semibold text-gray-900">📅 Activity Calendar</h3>
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2 text-sm text-gray-600">
                            <span>Less</span>
                            <div class="flex space-x-1">
                                <div class="w-3 h-3 bg-gray-200 rounded-sm"></div>
                                <div class="w-3 h-3 bg-green-200 rounded-sm"></div>
                                <div class="w-3 h-3 bg-green-400 rounded-sm"></div>
                                <div class="w-3 h-3 bg-green-600 rounded-sm"></div>
                                <div class="w-3 h-3 bg-green-800 rounded-sm"></div>
                            </div>
                            <span>More</span>
                        </div>
                    </div>
                </div>
                <div id="activity-calendar" class="grid grid-cols-7 gap-1">
                    <!-- Calendar will be generated by JavaScript -->
                </div>
            </div>

            <!-- Insights & Recommendations -->
            <div class="bg-gradient-to-r from-indigo-300 to-purple-400 rounded-2xl shadow-xl p-8 text-white">
                <h3 class="text-2xl font-bold mb-6">💡 AI Insights & Recommendations</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-white bg-opacity-10 rounded-xl p-6">
                        <div class="text-4xl mb-3">🎯</div>
                        <h4 class="text-lg font-semibold mb-2">Performance Insight</h4>
                        <p class="text-sm opacity-90">Your consistency has improved by 25% this month! You're most active on weekdays between 7-9 AM. Consider scheduling more weekend activities to maintain momentum.</p>
                    </div>
                    <div class="bg-white bg-opacity-10 rounded-xl p-6">
                        <div class="text-4xl mb-3">🚀</div>
                        <h4 class="text-lg font-semibold mb-2">Next Level Goal</h4>
                        <p class="text-sm opacity-90">You're 20 points away from Level 2! Focus on completing nutrition goals this week to unlock new achievements and features.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="challenges-page" class="page-content hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Challenges Header -->
            <div class="bg-gradient-to-r from-orange-400 to-red-400 rounded-2xl shadow-xl p-8 text-white mb-8">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-4xl font-bold mb-2">🏆 Wellness Challenges</h1>
                        <p class="text-xl opacity-90">Push your limits and unlock amazing rewards!</p>
                    </div>
                    <div class="text-right">
                        <div class="text-3xl font-bold mb-1" id="challenges-completed">0/12</div>
                        <div class="text-sm opacity-80">Challenges Completed</div>
                        <div class="w-48 bg-white bg-opacity-20 rounded-full h-3 mt-2">
                            <div id="challenges-progress-bar" class="bg-white h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Challenge Categories -->
            <div class="flex flex-wrap gap-4 mb-8">
                <button class="challenge-category-btn bg-purple-400 text-white px-6 py-3 rounded-xl font-semibold transition-all hover:bg-purple-500 transform hover:scale-105" data-category="all">
                    🌟 All Challenges
                </button>
                <button class="challenge-category-btn bg-white text-gray-700 px-6 py-3 rounded-xl font-semibold border-2 border-gray-200 transition-all hover:border-purple-300" data-category="cardio">
                    🏃‍♂️ Cardio
                </button>
                <button class="challenge-category-btn bg-white text-gray-700 px-6 py-3 rounded-xl font-semibold border-2 border-gray-200 transition-all hover:border-orange-300" data-category="nutrition">
                    🥗 Nutrition
                </button>
                <button class="challenge-category-btn bg-white text-gray-700 px-6 py-3 rounded-xl font-semibold border-2 border-gray-200 transition-all hover:border-pink-300" data-category="lifestyle">
                    🧘‍♀️ Lifestyle
                </button>
                <button class="challenge-category-btn bg-white text-gray-700 px-6 py-3 rounded-xl font-semibold border-2 border-gray-200 transition-all hover:border-orange-300" data-category="social">
                    👥 Social
                </button>
            </div>

            <!-- Active Challenges -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">🔥 Active Challenges</h2>
                <div class="grid lg:grid-cols-2 gap-6" id="active-challenges">
                    <!-- Active challenges will be populated by JavaScript -->
                </div>
            </div>

            <!-- Available Challenges -->
            <div class="mb-8">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">🎯 Available Challenges</h2>
                    <div class="text-sm text-gray-600">
                        <span class="font-semibold text-orange-600">New challenges</span> added weekly!
                    </div>
                </div>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="available-challenges">
                    <!-- Available challenges will be populated by JavaScript -->
                </div>
            </div>

            <!-- Completed Challenges -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">✅ Completed Challenges</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="completed-challenges">
                    <div class="text-center py-12 col-span-full">
                        <div class="text-6xl mb-4">🎉</div>
                        <h3 class="text-xl font-semibold text-gray-900 mb-2">Ready to Conquer?</h3>
                        <p class="text-gray-600">Complete challenges to see them here and earn amazing rewards!</p>
                    </div>
                </div>
            </div>

            <!-- Challenge Leaderboard -->
            <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-semibold text-gray-900">🏅 Weekly Leaderboard</h3>
                    <div class="text-sm text-gray-600">Updates every Monday</div>
                </div>
                <div class="space-y-4">
                    <div class="flex items-center justify-between p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl border-2 border-yellow-200">
                        <div class="flex items-center space-x-4">
                            <div class="text-2xl">🥇</div>
                            <div>
                                <div class="font-semibold text-gray-900">Sarah M.</div>
                                <div class="text-sm text-gray-600">12 challenges completed</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-yellow-600">2,450 pts</div>
                            <div class="text-xs text-gray-500">This week</div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between p-4 bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl border-2 border-gray-200">
                        <div class="flex items-center space-x-4">
                            <div class="text-2xl">🥈</div>
                            <div>
                                <div class="font-semibold text-gray-900">Mike R.</div>
                                <div class="text-sm text-gray-600">10 challenges completed</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-gray-600">2,100 pts</div>
                            <div class="text-xs text-gray-500">This week</div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between p-4 bg-gradient-to-r from-orange-50 to-red-50 rounded-xl border-2 border-orange-200">
                        <div class="flex items-center space-x-4">
                            <div class="text-2xl">🥉</div>
                            <div>
                                <div class="font-semibold text-gray-900">Alex K.</div>
                                <div class="text-sm text-gray-600">9 challenges completed</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-orange-600">1,890 pts</div>
                            <div class="text-xs text-gray-500">This week</div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between p-4 bg-gradient-to-r from-purple-50 to-orange-50 rounded-xl border-2 border-purple-200">
                        <div class="flex items-center space-x-4">
                            <div class="text-2xl">🎯</div>
                            <div>
                                <div class="font-semibold text-purple-600" id="user-leaderboard-name">You</div>
                                <div class="text-sm text-gray-600"><span id="user-challenges-count">0</span> challenges completed</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-purple-600"><span id="user-weekly-points">0</span> pts</div>
                            <div class="text-xs text-gray-500">This week</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Challenge Tips & Motivation -->
            <div class="bg-gradient-to-r from-indigo-300 to-purple-400 rounded-2xl shadow-xl p-8 text-white">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold">💪 Challenge Tips</h3>
                    <button id="refresh-challenge-tip" class="bg-white bg-opacity-20 hover:bg-opacity-30 px-4 py-2 rounded-xl transition-all">
                        🔄 New Tip
                    </button>
                </div>
                <div id="challenge-tip" class="text-lg opacity-90 mb-4">
                    "Start with small, achievable goals. Every challenge you complete builds momentum for the next one!"
                </div>
                <div class="flex items-center space-x-6 text-sm opacity-75">
                    <div class="flex items-center space-x-2">
                        <span>🎯</span>
                        <span>Set realistic goals</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span>👥</span>
                        <span>Find an accountability partner</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span>🏆</span>
                        <span>Celebrate small wins</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="community-page" class="page-content hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="mb-8 text-center">
                <div class="text-6xl mb-4">👥</div>
                <h2 class="text-3xl font-bold text-gray-900 mb-2">AHELP Community</h2>
                <p class="text-gray-600 max-w-3xl mx-auto">Connect with colleagues to share progress, inspire each other, and celebrate milestones together. Our community is a safe space to discuss your wellness journey and find support.</p>
            </div>
            <div class="grid md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover text-center">
                    <div class="text-4xl mb-3">💬</div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-1">Discussion Forums</h3>
                    <p class="text-gray-600 mb-3">Share your experiences, ask questions, and learn from the community in themed discussion boards.</p>
                    <button class="text-purple-400 font-semibold hover:underline">Coming Soon</button>
                </div>
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover text-center">
                    <div class="text-4xl mb-3">📅</div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-1">Local Events</h3>
                    <p class="text-gray-600 mb-3">Find group workouts and wellness events happening near you and join in on the fun.</p>
                    <button class="text-orange-400 font-semibold hover:underline">Coming Soon</button>
                </div>
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover text-center">
                    <div class="text-4xl mb-3">🤝</div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-1">Support Circles</h3>
                    <p class="text-gray-600 mb-3">Connect with small groups of peers for accountability, encouragement, and shared goals.</p>
                    <button class="text-pink-400 font-semibold hover:underline">Coming Soon</button>
                </div>
            </div>
            <div class="text-center">
                <button class="bg-gradient-to-r from-purple-400 to-orange-300 text-white px-6 py-3 rounded-xl font-semibold hover:from-purple-500 hover:to-orange-400 transition-all transform hover:scale-105">
                    Invite a Colleague
                </button>
            </div>
        </div>

        <div id="resources-page" class="page-content hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="mb-8 text-center">
                <div class="text-6xl mb-4">📚</div>
                <h2 class="text-3xl font-bold text-gray-900 mb-2">Curated Health Guides</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">Explore articles and guides to support every aspect of your wellness journey. These resources are selected to empower you with practical tips and inspiration.</p>
            </div>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
                    <div class="text-3xl mb-4">🥗</div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">Healthy Eating 101</h3>
                    <p class="text-gray-600 mb-4">Learn the basics of balanced nutrition and how to incorporate more whole foods into your meals.</p>
                    <a href="#" class="text-purple-400 font-semibold hover:underline">Read More →</a>
                </div>
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
                    <div class="text-3xl mb-4">🏃‍♂️</div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">Beginner Cardio Guide</h3>
                    <p class="text-gray-600 mb-4">Discover simple cardio routines suitable for all fitness levels to get your heart pumping.</p>
                    <a href="#" class="text-orange-400 font-semibold hover:underline">Read More →</a>
                </div>
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
                    <div class="text-3xl mb-4">🧘‍♀️</div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">Stress Management</h3>
                    <p class="text-gray-600 mb-4">Explore mindfulness techniques and breathing exercises to calm your mind and reduce stress.</p>
                    <a href="#" class="text-pink-400 font-semibold hover:underline">Read More →</a>
                </div>
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
                    <div class="text-3xl mb-4">💧</div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">Hydration Habits</h3>
                    <p class="text-gray-600 mb-4">Understand how hydration impacts your health and get creative ideas to increase your water intake.</p>
                    <a href="#" class="text-blue-400 font-semibold hover:underline">Read More →</a>
                </div>
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
                    <div class="text-3xl mb-4">🛌</div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">Sleep Well</h3>
                    <p class="text-gray-600 mb-4">Improve your sleep hygiene with proven strategies for better rest and recovery.</p>
                    <a href="#" class="text-indigo-400 font-semibold hover:underline">Read More →</a>
                </div>
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
                    <div class="text-3xl mb-4">🍏</div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">Meal Planning Made Easy</h3>
                    <p class="text-gray-600 mb-4">Get tips and templates for planning healthy meals that fit your schedule and budget.</p>
                    <a href="#" class="text-green-400 font-semibold hover:underline">Read More →</a>
                </div>
            </div>
        </div>

        <div id="profile-page" class="page-content hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="grid lg:grid-cols-3 gap-8">
                <!-- Profile card -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover">
                        <img id="dashboard-profile-picture" src="logo.png" alt="Profile Image" class="w-32 h-32 rounded-full mx-auto mb-4 object-cover">
                        <h3 class="text-2xl font-bold text-gray-900 mb-2">Welcome, <span id="profile-name" class="bg-gradient-to-r from-purple-400 to-orange-300 bg-clip-text text-transparent">User</span></h3>
                        <p class="text-gray-600 mb-1">Email: <span id="profile-email" class="font-semibold text-gray-800"></span></p>
                        <p class="text-gray-600 mb-1">Level: <span id="profile-level" class="font-semibold text-orange-600">1</span></p>
                        <p class="text-gray-600 mb-4">Total Points: <span id="profile-total-points" class="font-semibold text-purple-600">0</span></p>
                        <p class="text-gray-600 mb-4">Leave Time: <span id="profile-leave" class="font-semibold text-orange-500">0h</span></p>
                        <button id="edit-profile-btn" class="bg-gradient-to-r from-purple-400 to-orange-300 text-white px-4 py-2 rounded-xl font-semibold hover:from-purple-500 hover:to-orange-400 transition-all">Edit Profile</button>
                    </div>
                </div>
                <!-- Achievements section -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-2xl shadow-xl p-6">
                        <h3 class="text-xl font-semibold text-gray-900 mb-4">🏆 Your Achievements</h3>
                        <div id="profile-achievements" class="grid md:grid-cols-2 gap-4">
                            <!-- Achievements inserted via JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="settings-page" class="page-content hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="max-w-2xl mx-auto">
                <div class="bg-white rounded-2xl shadow-xl p-6 space-y-6">
                    <h3 class="text-xl font-semibold text-gray-900">⚙️ Settings</h3>
                    <div class="flex items-center justify-between">
                        <span class="text-gray-700">Dark Mode</span>
                        <button id="settings-dark-toggle" class="relative inline-flex items-center h-6 w-12 rounded-full transition-colors bg-gray-300">
                            <span class="sr-only">Toggle Dark Mode</span>
                            <span id="settings-dark-thumb" class="inline-block h-5 w-5 transform bg-white rounded-full transition-transform"></span>
                        </button>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-gray-700">Notifications</span>
                        <button id="settings-notifications-toggle" class="relative inline-flex items-center h-6 w-12 rounded-full transition-colors bg-gray-300">
                            <span class="sr-only">Toggle Notifications</span>
                            <span id="settings-notifications-thumb" class="inline-block h-5 w-5 transform bg-white rounded-full transition-transform"></span>
                        </button>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-gray-700">Logout</span>
                        <button id="settings-logout" class="text-red-600 font-semibold hover:text-red-700 transition-all">Sign Out</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Redemption Page: users can redeem points for leave time -->
        <div id="redeem-page" class="page-content hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="mb-8 text-center">
                <div class="text-6xl mb-4">🎁</div>
                <h2 class="text-3xl font-bold text-gray-900 mb-2">Redeem Your Points</h2>
                <p class="text-gray-600 max-w-3xl mx-auto">Exchange your hard‑earned wellness points for paid time off. Each redemption will deduct points from your balance and add hours to your available leave.</p>
            </div>
            <div class="text-center mb-6">
                <p class="text-lg text-gray-700 font-medium">Available Points: <span id="redeem-points" class="font-bold text-purple-600">0</span></p>
                <p class="text-lg text-gray-700 font-medium">Leave Time Available: <span id="redeem-leave" class="font-bold text-orange-500">0h</span></p>
            </div>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover" data-hours="1" data-cost="100">
                    <h3 class="text-xl font-semibold mb-2">1 Hour Off</h3>
                    <p class="text-gray-600 mb-4">Cost: 100 points</p>
                    <button class="redeem-btn bg-gradient-to-r from-purple-400 to-orange-300 text-white px-4 py-3 rounded-xl font-semibold shadow-lg hover:from-purple-500 hover:to-orange-400 transition-all">Redeem</button>
                </div>
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover" data-hours="2" data-cost="200">
                    <h3 class="text-xl font-semibold mb-2">2 Hours Off</h3>
                    <p class="text-gray-600 mb-4">Cost: 200 points</p>
                    <button class="redeem-btn bg-gradient-to-r from-purple-400 to-orange-300 text-white px-4 py-3 rounded-xl font-semibold shadow-lg hover:from-purple-500 hover:to-orange-400 transition-all">Redeem</button>
                </div>
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover" data-hours="4" data-cost="350">
                    <h3 class="text-xl font-semibold mb-2">4 Hours Off</h3>
                    <p class="text-gray-600 mb-4">Cost: 350 points</p>
                    <button class="redeem-btn bg-gradient-to-r from-purple-400 to-orange-300 text-white px-4 py-3 rounded-xl font-semibold shadow-lg hover:from-purple-500 hover:to-orange-400 transition-all">Redeem</button>
                </div>
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover" data-hours="8" data-cost="600">
                    <h3 class="text-xl font-semibold mb-2">8 Hours Off</h3>
                    <p class="text-gray-600 mb-4">Cost: 600 points</p>
                    <button class="redeem-btn bg-gradient-to-r from-purple-400 to-orange-300 text-white px-4 py-3 rounded-xl font-semibold shadow-lg hover:from-purple-500 hover:to-orange-400 transition-all">Redeem</button>
                </div>
                <div class="bg-white rounded-2xl shadow-xl p-6 text-center card-hover" data-hours="24" data-cost="1500">
                    <h3 class="text-xl font-semibold mb-2">24 Hours Off</h3>
                    <p class="text-gray-600 mb-4">Cost: 1500 points</p>
                    <button class="redeem-btn bg-gradient-to-r from-purple-400 to-orange-300 text-white px-4 py-3 rounded-xl font-semibold shadow-lg hover:from-purple-500 hover:to-orange-400 transition-all">Redeem</button>
                </div>
            </div>
        </div>

    </div>

    <!-- Notification Container -->
    <div id="notification-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- Back to Top Button -->
    <button id="back-to-top" class="hidden fixed bottom-6 right-6 bg-purple-400 text-white p-3 rounded-full shadow-lg hover:bg-purple-500 transition-colors" aria-label="Back to Top">↑</button>

    <script>
        // Enhanced App State
        let userData = {
            name: '',
            email: '',
            points: 0,
            weeklyPoints: 0,
            cardioStreak: 0,
            nutritionStreak: 0,
            tobaccoStreak: 0,
            todayCardio: 0,
            activities: [],
            achievements: [],
            mood: 'good',
            darkMode: false,
            level: 1,
            // Accumulated leave hours redeemed via the rewards programme
            leaveTime: 0
            ,
            /**
             * Hydration tracking
             * waterCount – number of glasses of water logged today
             * waterGoal  – glasses required per day to complete the hydration challenge
             * waterStreak – number of days where the water goal has been achieved
             */
            waterCount: 0,
            waterGoal: 8,
            waterStreak: 0
            ,
            /**
             * Steps tracking
             * stepsCount – number of steps logged today
             * stepsGoal  – daily step goal for the user (default 10000)
             */
            stepsCount: 0,
            stepsGoal: 10000
        };

        // Weekly points cap: set a limit to the points that can be earned each week.  This helps ensure users
        // don’t accumulate unlimited points by spamming logs.  Feel free to tweak the limit for your programme.
        const WEEKLY_POINTS_LIMIT = 200;

        /**
         * Award points to the user without exceeding the weekly cap.  Returns the number of points actually
         * awarded.  If the weekly cap has already been reached, this function returns 0.
         *
         * @param {number} amount The number of points to award
         * @returns {number} The actual points granted (may be 0)
         */
        function awardPoints(amount) {
            // Calculate how many points remain available this week
            const remaining = WEEKLY_POINTS_LIMIT - userData.weeklyPoints;
            // Award the lesser of the requested amount and the remaining allowance
            const points = Math.max(0, Math.min(amount, remaining));
            userData.points += points;
            userData.weeklyPoints += points;
            return points;
        }

        // --- Custom integration for multi‑page version ---
        // When arriving from the standalone login page, pick up the stored name
        // from localStorage.  If a name has been stored by the login/signup page
        // then prefer that over the empty default.  This allows the dashboard to
        // greet the user even when the login screen is removed.  Fallback to
        // "User" if nothing is found.
        const storedName = localStorage.getItem('ahelpUserName');
        if (storedName && storedName.trim().length > 0) {
            userData.name = storedName;
        } else if (!userData.name) {
            userData.name = 'User';
        }
        // Once the DOM is ready ensure the user name placeholder is populated.
        document.addEventListener('DOMContentLoaded', () => {
            const userNameEl = document.getElementById('user-name');
            if (userNameEl) {
                userNameEl.textContent = userData.name;
            }
            // Apply previously saved dark mode state
            try {
                const savedDark = localStorage.getItem('darkMode');
                if (savedDark === 'true') {
                    userData.darkMode = true;
                    document.body.classList.add('dark-mode');
                    const iconMoon = document.getElementById('icon-moon');
                    const iconSun  = document.getElementById('icon-sun');
                    if (iconMoon && iconSun) {
                        iconMoon.classList.add('hidden');
                        iconSun.classList.remove('hidden');
                    }
                }
            } catch (e) {}
            // Immediately update the dashboard stats and visualisations when the page loads
            if (typeof updateDisplay === 'function') {
                updateDisplay();
            }
        });

        // Enhanced tips array
        const dailyTips = [
            "The journey of a thousand miles begins with a single step. Every healthy choice you make today is an investment in your future self.",
            "Small consistent actions lead to big results. Focus on progress, not perfection.",
            "Your body is your temple. Treat it with respect, nourish it with good food, and move it with joy.",
            "Wellness isn't a destination, it's a way of living. Embrace the journey and celebrate every victory.",
            "The best time to plant a tree was 20 years ago. The second best time is now. Start your wellness journey today!",
            "You don't have to be great to get started, but you have to get started to be great.",
            "Health is not about the weight you lose, but about the life you gain.",
            "Every workout, every healthy meal, every good night's sleep is a gift to your future self."
        ];

        // Initialize particles
        function createParticles() {
            const particles = document.getElementById('particles');
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 3 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 2) + 's';
                particles.appendChild(particle);
            }
        }

        // Enhanced login/signup functionality
        const loginScreen = document.getElementById('login-screen');
        const dashboard = document.getElementById('dashboard');
        const loginTab = document.getElementById('login-tab');
        const signupTab = document.getElementById('signup-tab');
        const loginForm = document.getElementById('login-form');
        const signupForm = document.getElementById('signup-form');

        loginTab.addEventListener('click', () => {
            loginTab.classList.add('bg-white', 'shadow-lg', 'text-gray-900');
            loginTab.classList.remove('text-gray-600');
            signupTab.classList.remove('bg-white', 'shadow-lg', 'text-gray-900');
            signupTab.classList.add('text-gray-600');
            loginForm.classList.remove('hidden');
            signupForm.classList.add('hidden');
        });

        signupTab.addEventListener('click', () => {
            signupTab.classList.add('bg-white', 'shadow-lg', 'text-gray-900');
            signupTab.classList.remove('text-gray-600');
            loginTab.classList.remove('bg-white', 'shadow-lg', 'text-gray-900');
            loginTab.classList.add('text-gray-600');
            signupForm.classList.remove('hidden');
            loginForm.classList.add('hidden');
        });

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = loginForm.querySelector('input[type="email"]').value;
            userData.name = email.split('@')[0];
            userData.email = email;
            showDashboard();
        });

        signupForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const firstName = signupForm.querySelector('input[placeholder="John"]').value;
            const signupEmail = signupForm.querySelector('input[type="email"]').value;
            userData.name = firstName;
            userData.email = signupEmail;
            showDashboard();
        });

        function showDashboard() {
            loginScreen.classList.add('hidden');
            dashboard.classList.remove('hidden');
            document.getElementById('user-name').textContent = userData.name;
            updateDisplay();
            createConfetti();
            showEnhancedNotification(`🎉 Welcome ${userData.name}! Your wellness journey begins now!`, 'success');
        }

        // Enhanced logout
        document.getElementById('logout-btn').addEventListener('click', () => {
            dashboard.classList.add('hidden');
            loginScreen.classList.remove('hidden');
            loginForm.reset();
            signupForm.reset();
            showEnhancedNotification('👋 See you soon! Keep up the great work!', 'info');
        });

        // Navigation functionality
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const page = btn.dataset.page;
                
                // Update nav buttons
                document.querySelectorAll('.nav-btn').forEach(b => {
                    b.classList.remove('text-purple-600', 'font-semibold');
                    b.classList.add('text-gray-700');
                });
                btn.classList.add('text-purple-600', 'font-semibold');
                btn.classList.remove('text-gray-700');
                
                // Show selected page
                document.querySelectorAll('.page-content').forEach(p => p.classList.add('hidden'));
                document.getElementById(`${page}-page`).classList.remove('hidden');
            });
        });

        // Dark mode toggle
        document.getElementById('dark-mode-toggle').addEventListener('click', () => {
            // Flip the darkMode flag and apply/remove the dark mode class on the body
            userData.darkMode = !userData.darkMode;
            document.body.classList.toggle('dark-mode', userData.darkMode);
            // Persist the dark mode preference so other pages stay in sync
            try {
                localStorage.setItem('darkMode', userData.darkMode);
            } catch (e) {}

            // Toggle visibility of the moon and sun icons; in light mode show the moon (meaning you can switch to dark)
            const iconMoon = document.getElementById('icon-moon');
            const iconSun  = document.getElementById('icon-sun');
            if (userData.darkMode) {
                iconMoon.classList.add('hidden');
                iconSun.classList.remove('hidden');
            } else {
                iconMoon.classList.remove('hidden');
                iconSun.classList.add('hidden');
            }

            // Show a toast letting the user know which mode is active
            showEnhancedNotification(userData.darkMode ? 'Dark mode activated!' : 'Light mode activated!', 'info');
        });

        // Voice command (demo)
        document.getElementById('voice-command').addEventListener('click', () => {
            showEnhancedNotification('Voice command activated! Say "Log cardio" or "Show progress"', 'info');
        });

        // Enhanced cardio tracking
        document.getElementById('log-cardio').addEventListener('click', () => {
            const minutes = parseInt(document.getElementById('cardio-minutes').value) || 0;
            const type = document.getElementById('cardio-type').value;
            
            if (minutes > 0) {
                userData.todayCardio += minutes;
                // Award up to 10 points while respecting the weekly cap
                const pointsAwarded = awardPoints(10);
                userData.cardioStreak += 1;
                
                addActivity(`Logged ${minutes} minutes of ${type}`, `+${pointsAwarded} points`, getActivityIcon(type));
                checkAchievements();
                checkLevelUp();
                updateDisplay();
                updateChallengeProgressFromActivity();
                createConfetti();
                
                document.getElementById('cardio-minutes').value = '';
                if (pointsAwarded === 0) {
                    showEnhancedNotification(`🔥 Great job! ${minutes} minutes of ${type} logged, but you've reached your weekly points cap. No points awarded.`, 'info');
                } else {
                    showEnhancedNotification(`🔥 Amazing! ${minutes} minutes of ${type} logged! +${pointsAwarded} points earned`, 'success');
                }
            } else {
                showEnhancedNotification('⚠️ Please enter minutes of cardio', 'error');
            }
        });

        // Enhanced nutrition tracking
        document.getElementById('log-nutrition').addEventListener('click', () => {
            const checks = document.querySelectorAll('.nutrition-check:checked');
            
            if (checks.length > 0) {
                // Award up to 15 points while respecting weekly cap
                const pointsAwarded = awardPoints(15);
                userData.nutritionStreak += 1;
                
                addActivity(`Completed ${checks.length}/4 nutrition goals`, `+${pointsAwarded} points`, '🥗');
                checkAchievements();
                checkLevelUp();
                updateDisplay();
                createConfetti();
                
                document.querySelectorAll('.nutrition-check').forEach(check => check.checked = false);
                if (pointsAwarded === 0) {
                    showEnhancedNotification(`🌟 Fantastic! ${checks.length} nutrition goals completed! Weekly points cap reached, no points awarded.`, 'info');
                } else {
                    showEnhancedNotification(`🌟 Fantastic! ${checks.length} nutrition goals completed! +${pointsAwarded} points earned`, 'success');
                }
            } else {
                showEnhancedNotification('⚠️ Please select at least one nutrition goal', 'error');
            }
        });

        // Enhanced tobacco free tracking
        document.getElementById('log-tobacco').addEventListener('click', () => {
            const checked = document.getElementById('tobacco-free-today').checked;
            
            if (checked) {
                // Award up to 20 points while respecting weekly cap
                const pointsAwarded = awardPoints(20);
                userData.tobaccoStreak += 1;
                
                addActivity(`Day ${userData.tobaccoStreak} tobacco free!`, `+${pointsAwarded} points`, '🚭');
                checkAchievements();
                checkLevelUp();
                updateDisplay();
                updateHealthBenefit();
                updateChallengeProgressFromActivity();
                createConfetti();
                
                document.getElementById('tobacco-free-today').checked = false;
                if (pointsAwarded === 0) {
                    showEnhancedNotification(`💪 Incredible! Day ${userData.tobaccoStreak} tobacco free! Weekly points cap reached, no points awarded.`, 'info');
                } else {
                    showEnhancedNotification(`💪 Incredible! Day ${userData.tobaccoStreak} tobacco free! +${pointsAwarded} points earned`, 'success');
                }
            } else {
                showEnhancedNotification('⚠️ Please confirm you stayed tobacco free today', 'error');
            }
        });

        // Hydration tracking
        const logWaterBtn = document.getElementById('log-water');
        if (logWaterBtn) {
            logWaterBtn.addEventListener('click', () => {
                const glasses = parseInt(document.getElementById('water-count-input').value) || 0;
                if (glasses > 0) {
                    userData.waterCount += glasses;
                    // Award up to 5 points while respecting weekly cap
                    const pointsAwarded = awardPoints(5);
                    // Increase water streak when daily goal met
                    if (userData.waterCount >= userData.waterGoal) {
                        userData.waterStreak += 1;
                    }
                    addActivity(`Drank ${glasses} glasses of water`, `+${pointsAwarded} points`, '💧');
                    checkAchievements();
                    checkLevelUp();
                    updateDisplay();
                    updateChallengeProgressFromActivity();
                    createConfetti();
                    document.getElementById('water-count-input').value = '';
                    if (pointsAwarded === 0) {
                        showEnhancedNotification(`💧 Great job hydrating! ${glasses} glasses logged, but weekly points cap reached. No points awarded.`, 'info');
                    } else {
                        showEnhancedNotification(`💧 Great job hydrating! ${glasses} glasses logged. +${pointsAwarded} points earned`, 'success');
                    }
                } else {
                    showEnhancedNotification('⚠️ Please enter number of glasses', 'error');
                }
            });
        }

        // Steps tracking
        const logStepsBtn = document.getElementById('log-steps');
        if (logStepsBtn) {
            logStepsBtn.addEventListener('click', () => {
                const steps = parseInt(document.getElementById('steps-count').value) || 0;
                if (steps > 0) {
                    userData.stepsCount += steps;
                    // Award 5 points for logging steps while respecting weekly cap
                    const pointsAwarded = awardPoints(5);
                    addActivity(`Logged ${steps} steps`, `+${pointsAwarded} points`, '👣');
                    // Update progress bar and goal label
                    updateStepsProgress();
                    checkAchievements();
                    checkLevelUp();
                    updateDisplay();
                    updateChallengeProgressFromActivity();
                    createConfetti();
                    document.getElementById('steps-count').value = '';
                    if (pointsAwarded === 0) {
                        showEnhancedNotification(`🚶 Great job! ${steps} steps logged, but weekly points cap reached. No points awarded.`, 'info');
                    } else {
                        showEnhancedNotification(`🚶 Great job! ${steps} steps logged. +${pointsAwarded} points earned`, 'success');
                    }
                } else {
                    showEnhancedNotification('⚠️ Please enter number of steps', 'error');
                }
            });
        }

        // Update steps progress bar and text. Pulls goal from userData or settings.
        function updateStepsProgress() {
            // Determine goal: use userData.stepsGoal if defined, else fallback to settingsStepsGoal
            let goal = userData.stepsGoal;
            try {
                const storedGoal = parseInt(localStorage.getItem('settingsStepsGoal'));
                if (!isNaN(storedGoal) && storedGoal > 0) {
                    goal = storedGoal;
                    userData.stepsGoal = goal;
                }
            } catch (err) {}
            const progress = Math.min((userData.stepsCount / goal) * 100, 100);
            const progressElem = document.getElementById('steps-progress');
            const textElem = document.getElementById('steps-progress-text');
            const goalLabel = document.getElementById('steps-goal-label');
            if (progressElem) progressElem.style.width = progress + '%';
            if (textElem) textElem.textContent = `${userData.stepsCount} steps logged`;
            if (goalLabel) goalLabel.textContent = `Goal: ${goal} steps`;
        }

        // Mood tracking
        document.querySelectorAll('.mood-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const mood = btn.dataset.mood;
                userData.mood = mood;
                // Update the mood display with the selected mood label
                document.getElementById('current-mood').textContent = btn.textContent.trim();
                
                // Reset all buttons
                document.querySelectorAll('.mood-btn').forEach(b => {
                    b.classList.remove('bg-white', 'bg-opacity-40');
                    b.classList.add('bg-white', 'bg-opacity-20');
                });
                
                // Highlight selected
                btn.classList.remove('bg-opacity-20');
                btn.classList.add('bg-opacity-40');
                
                // Award up to 5 points while respecting weekly cap
                const pointsAwarded = awardPoints(5);
                addActivity(`Mood logged: ${mood}`, `+${pointsAwarded} points`, mood);
                updateDisplay();
                
                if (pointsAwarded === 0) {
                    showEnhancedNotification('😊 Mood logged! Weekly points cap reached, no points awarded.', 'info');
                } else {
                    showEnhancedNotification('😊 Mood logged! Thanks for checking in. +' + pointsAwarded + ' points earned', 'info');
                }
            });
        });

        // Enhanced progress tracking functions
        function updateNutritionProgress() {
            const checkedCount = document.querySelectorAll('.nutrition-check:checked').length;
            document.getElementById('nutrition-progress-text').textContent = `${checkedCount}/4`;
            document.getElementById('nutrition-progress').style.width = `${(checkedCount / 4) * 100}%`;
        }

        document.querySelectorAll('.nutrition-check').forEach(check => {
            check.addEventListener('change', updateNutritionProgress);
        });

        document.getElementById('cardio-minutes').addEventListener('input', (e) => {
            const minutes = parseInt(e.target.value) || 0;
            const progress = Math.min((userData.todayCardio + minutes) / 30 * 100, 100);
            document.getElementById('cardio-progress').style.width = `${progress}%`;
            document.getElementById('cardio-today').textContent = `${userData.todayCardio + minutes} min logged`;
        });

        // Refresh tip functionality
        document.getElementById('refresh-tip').addEventListener('click', () => {
            const randomTip = dailyTips[Math.floor(Math.random() * dailyTips.length)];
            document.getElementById('daily-tip').textContent = randomTip;
            showEnhancedNotification('💡 New wellness tip loaded!', 'info');
        });

        function getActivityIcon(type) {
            const icons = {
                walking: '🚶‍♂️',
                running: '🏃‍♂️',
                cycling: '🚴‍♂️',
                swimming: '🏊‍♂️',
                dancing: '💃',
                yoga: '🧘‍♀️',
                other: '🏋️‍♂️'
            };
            return icons[type] || '🏃‍♂️';
        }

        function addActivity(description, points, icon) {
            const activity = {
                description,
                points,
                icon,
                time: new Date().toLocaleTimeString(),
                date: new Date().toDateString()
            };
            userData.activities.unshift(activity);
            
            if (userData.activities.length > 20) {
                userData.activities = userData.activities.slice(0, 20);
            }
            
            updateActivityLog();
        }

        function updateActivityLog() {
            const activityLog = document.getElementById('activity-log');
            
            if (userData.activities.length === 0) {
                activityLog.innerHTML = `
                    <div class="text-gray-500 text-center py-8 flex flex-col items-center">
                        <div class="text-4xl mb-2">🚀</div>
                        <div>Start tracking to see your amazing journey!</div>
                    </div>
                `;
                return;
            }
            
            activityLog.innerHTML = userData.activities.slice(0, 5).map(activity => `
                <div class="flex items-center space-x-4 p-4 bg-gradient-to-r from-purple-50 to-orange-50 rounded-xl slide-in">
                    <div class="text-2xl">${activity.icon}</div>
                    <div class="flex-1">
                        <div class="font-semibold text-gray-900">${activity.description}</div>
                        <div class="text-sm text-gray-600">${activity.time} • ${activity.points}</div>
                    </div>
                    <div class="text-orange-600 font-bold">${activity.points}</div>
                </div>
            `).join('');
        }

        function checkAchievements() {
            const achievements = [
                { id: 'first-cardio', condition: userData.cardioStreak >= 1, name: 'First Steps' },
                { id: 'nutrition-master', condition: userData.nutritionStreak >= 1, name: 'Nutrition Master' },
                { id: 'smoke-free-week', condition: userData.tobaccoStreak >= 7, name: 'Smoke Free Week' },
                { id: 'point-collector', condition: userData.points >= 100, name: 'Point Collector' },
                { id: 'cardio-warrior', condition: userData.cardioStreak >= 7, name: 'Cardio Warrior' },
                { id: 'wellness-champion', condition: userData.points >= 500, name: 'Wellness Champion' }
            ];

            achievements.forEach(achievement => {
                if (achievement.condition && !userData.achievements.includes(achievement.id)) {
                    userData.achievements.push(achievement.id);
                    unlockAchievement(achievement.id, achievement.name);
                }
            });
            
            document.getElementById('achievement-count').textContent = userData.achievements.length;
        }

        function unlockAchievement(id, name) {
            const badge = document.querySelector(`[data-achievement="${id}"]`);
            if (badge) {
                badge.classList.remove('opacity-50', 'border-dashed', 'border-gray-300');
                badge.classList.add('bg-gradient-to-br', 'from-yellow-100', 'to-orange-100', 'border-yellow-300', 'border-solid', 'achievement-unlock');
                
                setTimeout(() => {
                    badge.classList.remove('achievement-unlock');
                }, 1000);
            }
            
            showEnhancedNotification(`🏆 Achievement Unlocked: ${name}!`, 'achievement');
            createConfetti();
        }

        function checkLevelUp() {
            const newLevel = Math.floor(userData.points / 100) + 1;
            if (newLevel > userData.level) {
                userData.level = newLevel;
                showEnhancedNotification(`🎉 Level Up! You're now Level ${userData.level}!`, 'level-up');
                createConfetti();
            }
        }

        function updateHealthBenefit() {
            const days = userData.tobaccoStreak;
            let benefit = "Every day counts towards better health!";
            
            if (days >= 1) benefit = "Your circulation is already improving! 💓";
            if (days >= 3) benefit = "Your sense of taste and smell are getting better! 👃";
            if (days >= 7) benefit = "Your lung function is starting to improve! 🫁";
            if (days >= 14) benefit = "Your risk of heart attack is decreasing! ❤️";
            if (days >= 30) benefit = "Your lung capacity has significantly improved! 🌬️";
            
            document.getElementById('health-benefit').textContent = benefit;
        }

        function updateDisplay() {
            // Update points display
            document.getElementById('total-points').textContent = `${userData.points} Points`;
            document.getElementById('weekly-points').textContent = userData.weeklyPoints;

            // Update redemption displays if they exist
            const redeemPts = document.getElementById('redeem-points');
            const redeemLeave = document.getElementById('redeem-leave');
            if (redeemPts && redeemLeave) {
                redeemPts.textContent = userData.points;
                redeemLeave.textContent = `${userData.leaveTime}h`;
            }
            
            // Update streaks
            document.getElementById('cardio-streak').textContent = userData.cardioStreak;
            document.getElementById('nutrition-streak').textContent = userData.nutritionStreak;
            document.getElementById('tobacco-streak').textContent = userData.tobaccoStreak;
            document.getElementById('tobacco-days').textContent = userData.tobaccoStreak;
            
            // Update progress bars
            const weeklyProgress = Math.min((userData.weeklyPoints / 200) * 100, 100);
            document.getElementById('weekly-progress-bar').style.width = `${weeklyProgress}%`;
            
            const cardioProgress = Math.min((userData.todayCardio / 30) * 100, 100);
            document.getElementById('cardio-progress').style.width = `${cardioProgress}%`;
            document.getElementById('cardio-today').textContent = `${userData.todayCardio} min logged`;

            // Update hydration progress bar and display if elements exist
            const waterProgressElem = document.getElementById('water-progress');
            const waterTodayElem = document.getElementById('water-today');
            if (waterProgressElem && waterTodayElem) {
                const waterProgress = Math.min((userData.waterCount / userData.waterGoal) * 100, 100);
                waterProgressElem.style.width = `${waterProgress}%`;
                waterTodayElem.textContent = `${userData.waterCount} glasses logged`;
            }

            // Update steps progress if the steps card exists
            const stepsProgressElem = document.getElementById('steps-progress');
            if (stepsProgressElem) {
                updateStepsProgress();
            }
            
            // Update progress rings
            updateProgressRing('cardio-ring', userData.cardioStreak, 30);
            updateProgressRing('nutrition-ring', userData.nutritionStreak, 30);
            updateProgressRing('tobacco-ring', userData.tobaccoStreak, 30);

            // Also update the profile page fields when display updates
            updateProfile();
        }

        function updateProgressRing(ringId, value, max) {
            const ring = document.getElementById(ringId);
            const circumference = 175.93;
            const progress = Math.min(value / max, 1);
            const offset = circumference - (progress * circumference);
            ring.style.strokeDashoffset = offset;
        }

        /**
         * Update profile fields on the profile page. This function reads
         * values from the global userData object and populates the
         * corresponding elements in the profile card. It is called
         * whenever display is updated, ensuring the profile page always
         * reflects the latest name, email, level and points. It also
         * populates the achievements section with unlocked badges.
         */
        function updateProfile() {
            const nameEl = document.getElementById('profile-name');
            const levelEl = document.getElementById('profile-level');
            const pointsEl = document.getElementById('profile-total-points');
            const emailEl = document.getElementById('profile-email');
            const leaveEl = document.getElementById('profile-leave');
            if (nameEl) nameEl.textContent = userData.name || 'User';
            if (levelEl) levelEl.textContent = userData.level;
            if (pointsEl) pointsEl.textContent = userData.points;
            if (emailEl) emailEl.textContent = userData.email || '';
            if (leaveEl) leaveEl.textContent = `${userData.leaveTime}h`;

            // Update profile picture in dashboard profile card
            const profilePicEl = document.getElementById('dashboard-profile-picture');
            if (profilePicEl) {
                try {
                    const picData = localStorage.getItem('userProfilePic');
                    if (picData) {
                        profilePicEl.src = picData;
                    } else {
                        profilePicEl.src = 'logo.png';
                    }
                } catch (err) {
                    // fallback to default logo on error
                    profilePicEl.src = 'logo.png';
                }
            }
            // Render achievements in profile page
            const achievementsContainer = document.getElementById('profile-achievements');
            if (achievementsContainer) {
                achievementsContainer.innerHTML = '';
                const achievementDetails = {
                    'first-cardio': { icon: '🏃‍♂️', name: 'First Steps', desc: 'Log your first workout' },
                    'nutrition-master': { icon: '🥗', name: 'Nutrition Master', desc: 'Complete all nutrition goals' },
                    'smoke-free-week': { icon: '🚭', name: 'Smoke Free Week', desc: '7 days tobacco free' },
                    'point-collector': { icon: '⭐', name: 'Point Collector', desc: 'Earn 100 points' },
                    'cardio-warrior': { icon: '🔥', name: 'Cardio Warrior', desc: '7 day cardio streak' },
                    'wellness-champion': { icon: '🏆', name: 'Wellness Champion', desc: '500 points earned' }
                };
                userData.achievements.forEach(id => {
                    const detail = achievementDetails[id];
                    if (detail) {
                        const badge = document.createElement('div');
                        badge.className = 'flex items-start space-x-3 p-4 rounded-xl bg-gradient-to-r from-purple-50 to-orange-50 shadow-md';
                        badge.innerHTML = `
                            <div class="text-3xl">${detail.icon}</div>
                            <div>
                                <div class="font-semibold text-gray-900">${detail.name}</div>
                                <div class="text-sm text-gray-600">${detail.desc}</div>
                            </div>
                        `;
                        achievementsContainer.appendChild(badge);
                    }
                });
            }
        }

        function showEnhancedNotification(message, type = 'info') {
            const container = document.getElementById('notification-container');
            const notification = document.createElement('div');
            
            const colors = {
                // Use pastel tones for notifications to keep the UI gentle
                success: 'bg-orange-300',
                error: 'bg-red-400',
                info: 'bg-purple-400',
                achievement: 'bg-pink-300',
                'level-up': 'bg-orange-400'
            };
            
            notification.className = `notification ${colors[type]} text-white px-6 py-4 rounded-xl shadow-lg max-w-sm`;
            notification.innerHTML = `
                <div class="flex items-center space-x-3">
                    <div class="text-lg">${type === 'achievement' ? '🏆' : type === 'level-up' ? '🎉' : type === 'success' ? '✅' : type === 'error' ? '❌' : 'ℹ️'}</div>
                    <div class="font-medium">${message}</div>
                </div>
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('hide');
                setTimeout(() => {
                    container.removeChild(notification);
                }, 500);
            }, 4000);
        }

        function createConfetti() {
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                // Confetti colours matching the AHELP palette
                // Use a selection of pastel brand colours for a softer confetti effect
                confetti.style.backgroundColor = ['#f4c8e7', '#fae1dc', '#d8c6e0', '#f8d4d2', '#fdf1d8'][Math.floor(Math.random() * 5)];
                confetti.style.animationDelay = Math.random() * 3 + 's';
                document.body.appendChild(confetti);
                
                setTimeout(() => {
                    document.body.removeChild(confetti);
                }, 3000);
            }
        }

        // Progress page functionality
        let currentPeriod = 7;
        let activityChart, pointsChart;

        // Track whether notifications are enabled in settings
        let notificationsEnabled = true;

        // Period selector functionality
        document.querySelectorAll('.period-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                currentPeriod = parseInt(btn.dataset.period);
                
                // Update button styles
                document.querySelectorAll('.period-btn').forEach(b => {
                    b.classList.remove('bg-purple-600', 'text-white');
                    b.classList.add('text-gray-600');
                });
                btn.classList.add('bg-purple-600', 'text-white');
                btn.classList.remove('text-gray-600');
                
                updateProgressPage();
                showEnhancedNotification(`📊 Showing ${currentPeriod} day analysis`, 'info');
            });
        });

        function updateProgressPage() {
            // Update level display
            document.getElementById('progress-level').textContent = `Level ${userData.level}`;
            const levelProgress = (userData.points % 100) / 100 * 100;
            document.getElementById('progress-level-bar').style.width = `${levelProgress}%`;
            
            // Update key metrics based on current data
            const workoutCount = Math.max(userData.cardioStreak, 1);
            const totalMinutes = userData.todayCardio * workoutCount;
            const goalsCompleted = userData.achievements.length;
            const consistencyScore = Math.min(((userData.cardioStreak + userData.nutritionStreak + userData.tobaccoStreak) / 3 / currentPeriod * 100), 100);
            
            document.getElementById('total-workouts').textContent = workoutCount;
            document.getElementById('total-minutes').textContent = totalMinutes;
            document.getElementById('goals-completed').textContent = goalsCompleted;
            document.getElementById('consistency-score').textContent = Math.round(consistencyScore) + '%';
            
            // Update streak displays
            document.getElementById('streak-cardio').textContent = `${userData.cardioStreak} days`;
            document.getElementById('streak-nutrition').textContent = `${userData.nutritionStreak} days`;
            document.getElementById('streak-tobacco').textContent = `${userData.tobaccoStreak} days`;
            
            // Update charts
            updateCharts();
            generateActivityCalendar();
        }

        function updateCharts() {
            // Generate sample data based on current period
            const labels = [];
            const cardioData = [];
            const nutritionData = [];
            const pointsData = [];
            
            for (let i = currentPeriod - 1; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                labels.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
                
                // Generate realistic sample data
                cardioData.push(Math.floor(Math.random() * 60) + (i < userData.cardioStreak ? 20 : 0));
                nutritionData.push(Math.floor(Math.random() * 4) + (i < userData.nutritionStreak ? 2 : 0));
                pointsData.push(Math.floor(Math.random() * 50) + 10);
            }
            
            // Activity Chart
            const activityCtx = document.getElementById('activityChart').getContext('2d');
            if (activityChart) activityChart.destroy();
            
            activityChart = new Chart(activityCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Cardio Minutes',
                        data: cardioData,
                        borderColor: '#b37cd4',
                        backgroundColor: 'rgba(179, 124, 212, 0.2)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Nutrition Goals',
                        data: nutritionData,
                        borderColor: '#f5a392',
                        backgroundColor: 'rgba(245, 163, 146, 0.2)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 0
                    }
                }
            });
            
            // Points Chart
            const pointsCtx = document.getElementById('pointsChart').getContext('2d');
            if (pointsChart) pointsChart.destroy();
            
            pointsChart = new Chart(pointsCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Points Earned',
                        data: pointsData,
                        backgroundColor: 'rgba(244, 162, 97, 0.8)',
                        borderColor: '#f4a261',
                        borderWidth: 1,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 0
                    }
                }
            });
        }

        function generateActivityCalendar() {
            const calendar = document.getElementById('activity-calendar');
            calendar.innerHTML = '';
            
            // Generate last 49 days (7x7 grid)
            for (let i = 48; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                
                const day = document.createElement('div');
                day.className = 'w-4 h-4 rounded-sm cursor-pointer transition-all hover:scale-110';
                
                // Simulate activity levels
                const activityLevel = Math.random();
                if (activityLevel < 0.2) {
                    day.className += ' bg-gray-200';
                } else if (activityLevel < 0.4) {
                    day.className += ' bg-green-200';
                } else if (activityLevel < 0.6) {
                    day.className += ' bg-green-400';
                } else if (activityLevel < 0.8) {
                    day.className += ' bg-green-600';
                } else {
                    day.className += ' bg-green-800';
                }
                
                day.title = `${date.toDateString()}: ${Math.floor(activityLevel * 100)} activity points`;
                calendar.appendChild(day);
            }
        }

        // Navigation functionality enhancement
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const page = btn.dataset.page;
                
                // Update nav buttons
                document.querySelectorAll('.nav-btn').forEach(b => {
                    b.classList.remove('text-purple-600', 'font-semibold');
                    b.classList.add('text-gray-700');
                });
                btn.classList.add('text-purple-600', 'font-semibold');
                btn.classList.remove('text-gray-700');
                
                // Show selected page
                document.querySelectorAll('.page-content').forEach(p => p.classList.add('hidden'));
                document.getElementById(`${page}-page`).classList.remove('hidden');
                
                // Initialize progress page when navigated to
                if (page === 'progress') {
                    setTimeout(() => {
                        updateProgressPage();
                    }, 100);
                }
            });
        });

        // Challenges data and functionality
        let challengesData = {
            active: [],
            completed: [],
            available: [
                {
                    id: 'cardio-streak-7',
                    title: '7-Day Cardio Streak',
                    description: 'Complete cardio exercise for 7 consecutive days',
                    category: 'cardio',
                    difficulty: 'Medium',
                    points: 150,
                    duration: '7 days',
                    icon: '🏃‍♂️',
                    progress: 0,
                    target: 7,
                    type: 'streak'
                },
                {
                    id: 'nutrition-master',
                    title: 'Nutrition Master',
                    description: 'Complete all 4 nutrition goals for 5 days',
                    category: 'nutrition',
                    difficulty: 'Hard',
                    points: 200,
                    duration: '1 week',
                    icon: '🥗',
                    progress: 0,
                    target: 5,
                    type: 'count'
                },
                {
                    id: 'early-bird',
                    title: 'Early Bird Workout',
                    description: 'Exercise before 8 AM for 3 consecutive days',
                    category: 'lifestyle',
                    difficulty: 'Easy',
                    points: 100,
                    duration: '3 days',
                    icon: '🌅',
                    progress: 0,
                    target: 3,
                    type: 'streak'
                },
                {
                    id: 'water-warrior',
                    title: 'Hydration Hero',
                    description: 'Drink 8+ glasses of water daily for a week',
                    category: 'nutrition',
                    difficulty: 'Easy',
                    points: 120,
                    duration: '7 days',
                    icon: '💧',
                    progress: 0,
                    target: 7,
                    type: 'streak'
                },
                {
                    id: 'step-master',
                    title: '10K Steps Challenge',
                    description: 'Walk 10,000+ steps in a single day',
                    category: 'cardio',
                    difficulty: 'Medium',
                    points: 80,
                    duration: '1 day',
                    icon: '👟',
                    progress: 0,
                    target: 10000,
                    type: 'single'
                },
                {
                    id: 'mindful-week',
                    title: 'Mindful Week',
                    description: 'Practice meditation or yoga for 7 days',
                    category: 'lifestyle',
                    difficulty: 'Medium',
                    points: 140,
                    duration: '7 days',
                    icon: '🧘‍♀️',
                    progress: 0,
                    target: 7,
                    type: 'streak'
                },
                {
                    id: 'social-support',
                    title: 'Workout Buddy',
                    description: 'Exercise with a friend 3 times this week',
                    category: 'social',
                    difficulty: 'Easy',
                    points: 90,
                    duration: '1 week',
                    icon: '👥',
                    progress: 0,
                    target: 3,
                    type: 'count'
                },
                {
                    id: 'tobacco-free-month',
                    title: 'Smoke-Free Month',
                    description: 'Stay tobacco-free for 30 consecutive days',
                    category: 'lifestyle',
                    difficulty: 'Hard',
                    points: 500,
                    duration: '30 days',
                    icon: '🚭',
                    progress: 0,
                    target: 30,
                    type: 'streak'
                },
                {
                    id: 'healthy-meals',
                    title: 'Home Chef',
                    description: 'Cook 10 healthy meals at home',
                    category: 'nutrition',
                    difficulty: 'Medium',
                    points: 160,
                    duration: '2 weeks',
                    icon: '👨‍🍳',
                    progress: 0,
                    target: 10,
                    type: 'count'
                },
                {
                    id: 'weekend-warrior',
                    title: 'Weekend Warrior',
                    description: 'Complete 2+ hours of exercise this weekend',
                    category: 'cardio',
                    difficulty: 'Medium',
                    points: 100,
                    duration: '2 days',
                    icon: '⚡',
                    progress: 0,
                    target: 120,
                    type: 'single'
                },
                {
                    id: 'sleep-champion',
                    title: 'Sleep Champion',
                    description: 'Get 7+ hours of sleep for 5 nights',
                    category: 'lifestyle',
                    difficulty: 'Easy',
                    points: 110,
                    duration: '5 days',
                    icon: '😴',
                    progress: 0,
                    target: 5,
                    type: 'streak'
                },
                {
                    id: 'community-helper',
                    title: 'Community Motivator',
                    description: 'Encourage 5 friends to start their wellness journey',
                    category: 'social',
                    difficulty: 'Hard',
                    points: 250,
                    duration: '1 month',
                    icon: '🤝',
                    progress: 0,
                    target: 5,
                    type: 'count'
                }
            ]
        };

        const challengeTips = [
            "Start with small, achievable goals. Every challenge you complete builds momentum for the next one!",
            "Track your progress daily. Small consistent actions lead to big results over time.",
            "Find an accountability partner. You're 65% more likely to succeed with support!",
            "Celebrate every milestone. Acknowledging progress keeps you motivated for the long haul.",
            "Don't aim for perfection. Progress over perfection - every step forward counts!",
            "Mix different types of challenges. Variety keeps your wellness journey exciting and engaging.",
            "Set reminders and create habits. Consistency is the key to transforming challenges into lifestyle changes.",
            "Learn from setbacks. Every challenge teaches you something valuable about yourself."
        ];

        let currentChallengeCategory = 'all';

        // Challenge category filtering
        document.querySelectorAll('.challenge-category-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                currentChallengeCategory = btn.dataset.category;
                
                // Update button styles
                document.querySelectorAll('.challenge-category-btn').forEach(b => {
                    b.classList.remove('bg-purple-600', 'text-white');
                    b.classList.add('bg-white', 'text-gray-700', 'border-2', 'border-gray-200');
                });
                btn.classList.add('bg-purple-600', 'text-white');
                btn.classList.remove('bg-white', 'text-gray-700', 'border-2', 'border-gray-200');
                
                renderChallenges();
                showEnhancedNotification(`🎯 Showing ${currentChallengeCategory === 'all' ? 'all' : currentChallengeCategory} challenges`, 'info');
            });
        });

        // Challenge tip refresh
        document.getElementById('refresh-challenge-tip').addEventListener('click', () => {
            const randomTip = challengeTips[Math.floor(Math.random() * challengeTips.length)];
            document.getElementById('challenge-tip').textContent = randomTip;
            showEnhancedNotification('💡 New challenge tip loaded!', 'info');
        });

        function renderChallenges() {
            renderActiveChallenges();
            renderAvailableChallenges();
            renderCompletedChallenges();
            updateChallengesProgress();
        }

        function renderActiveChallenges() {
            const container = document.getElementById('active-challenges');
            
            if (challengesData.active.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <div class="text-6xl mb-4">🎯</div>
                        <h3 class="text-xl font-semibold text-gray-900 mb-2">No Active Challenges</h3>
                        <p class="text-gray-600 mb-4">Start a challenge below to begin your journey!</p>
                        <button class="bg-purple-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-purple-700 transition-all transform hover:scale-105" onclick="document.querySelector('[data-category=\\"all\\"]').click()">
                            🚀 Browse Challenges
                        </button>
                    </div>
                `;
                return;
            }

            container.innerHTML = challengesData.active.map(challenge => `
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover border-l-4 border-orange-300">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="text-3xl">${challenge.icon}</div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">${challenge.title}</h3>
                                <p class="text-sm text-gray-600">${challenge.description}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm font-semibold text-orange-600">${challenge.points} pts</div>
                            <div class="text-xs text-gray-500">${challenge.duration}</div>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-medium text-gray-700">Progress</span>
                            <span class="text-sm font-semibold text-orange-600">${challenge.progress}/${challenge.target}</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3">
                            <div class="bg-gradient-to-r from-orange-500 to-red-500 h-3 rounded-full transition-all duration-500" style="width: ${Math.min((challenge.progress / challenge.target) * 100, 100)}%"></div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 bg-${getDifficultyColor(challenge.difficulty)}-100 text-${getDifficultyColor(challenge.difficulty)}-800 text-xs font-medium rounded-full">
                                ${challenge.difficulty}
                            </span>
                            <span class="px-2 py-1 bg-gray-100 text-gray-800 text-xs font-medium rounded-full">
                                ${challenge.category}
                            </span>
                        </div>
                        <button class="abandon-challenge-btn text-red-600 hover:text-red-800 text-sm font-medium transition-all" data-challenge-id="${challenge.id}">
                            Abandon
                        </button>
                    </div>
                </div>
            `).join('');

            // Add abandon challenge functionality
            document.querySelectorAll('.abandon-challenge-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const challengeId = btn.dataset.challengeId;
                    abandonChallenge(challengeId);
                });
            });
        }

        function renderAvailableChallenges() {
            const container = document.getElementById('available-challenges');
            const filteredChallenges = currentChallengeCategory === 'all' 
                ? challengesData.available 
                : challengesData.available.filter(c => c.category === currentChallengeCategory);

            container.innerHTML = filteredChallenges.map(challenge => `
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover transition-all hover:shadow-2xl">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="text-3xl">${challenge.icon}</div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">${challenge.title}</h3>
                                <p class="text-sm text-gray-600">${challenge.description}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-lg font-bold text-purple-600">${challenge.points}</div>
                            <div class="text-xs text-gray-500">points</div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 bg-${getDifficultyColor(challenge.difficulty)}-100 text-${getDifficultyColor(challenge.difficulty)}-800 text-xs font-medium rounded-full">
                                ${challenge.difficulty}
                            </span>
                            <span class="px-2 py-1 bg-gray-100 text-gray-800 text-xs font-medium rounded-full">
                                ${challenge.category}
                            </span>
                        </div>
                        <div class="text-sm text-gray-600">
                            ⏱️ ${challenge.duration}
                        </div>
                    </div>
                    
                    <button class="start-challenge-btn w-full bg-gradient-to-r from-purple-400 to-orange-300 text-white py-3 px-4 rounded-xl font-semibold hover:from-purple-500 hover:to-orange-400 transition-all transform hover:scale-105" data-challenge-id="${challenge.id}">
                        🚀 Start Challenge
                    </button>
                </div>
            `).join('');

            // Add start challenge functionality
            document.querySelectorAll('.start-challenge-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const challengeId = btn.dataset.challengeId;
                    startChallenge(challengeId);
                });
            });
        }

        function renderCompletedChallenges() {
            const container = document.getElementById('completed-challenges');
            
            if (challengesData.completed.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12 col-span-full">
                        <div class="text-6xl mb-4">🎉</div>
                        <h3 class="text-xl font-semibold text-gray-900 mb-2">Ready to Conquer?</h3>
                        <p class="text-gray-600">Complete challenges to see them here and earn amazing rewards!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = challengesData.completed.map(challenge => `
                <div class="bg-gradient-to-br from-purple-50 to-orange-50 rounded-2xl shadow-xl p-6 border-2 border-orange-200">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="text-3xl">${challenge.icon}</div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">${challenge.title}</h3>
                                <p class="text-sm text-gray-600">${challenge.description}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-lg font-bold text-orange-600">✅</div>
                            <div class="text-xs text-gray-500">Completed</div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full">
                                +${challenge.points} pts earned
                            </span>
                        </div>
                        <div class="text-sm text-gray-600">
                            🏆 ${challenge.completedDate}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function startChallenge(challengeId) {
            const challenge = challengesData.available.find(c => c.id === challengeId);
            if (!challenge) return;

            // Move from available to active
            challengesData.available = challengesData.available.filter(c => c.id !== challengeId);
            challengesData.active.push({...challenge, startDate: new Date().toDateString()});

            renderChallenges();
            createConfetti();
            showEnhancedNotification(`🚀 Challenge "${challenge.title}" started! You've got this!`, 'success');
        }

        function abandonChallenge(challengeId) {
            const challenge = challengesData.active.find(c => c.id === challengeId);
            if (!challenge) return;

            // Move from active back to available and reset progress
            challengesData.active = challengesData.active.filter(c => c.id !== challengeId);
            const resetChallenge = {...challenge, progress: 0};
            delete resetChallenge.startDate;
            challengesData.available.push(resetChallenge);

            renderChallenges();
            showEnhancedNotification(`Challenge "${challenge.title}" abandoned. You can restart it anytime!`, 'info');
        }

        function completeChallenge(challengeId) {
            const challenge = challengesData.active.find(c => c.id === challengeId);
            if (!challenge) return;

            // Move from active to completed
            challengesData.active = challengesData.active.filter(c => c.id !== challengeId);
            challengesData.completed.push({
                ...challenge, 
                completedDate: new Date().toDateString()
            });

            // Award challenge points while respecting weekly cap
            const pointsAwarded = awardPoints(challenge.points);

            renderChallenges();
            updateDisplay();
            createConfetti();
            if (pointsAwarded === 0) {
                showEnhancedNotification('🏆 Challenge "' + challenge.title + '" completed! Weekly points cap reached, no points awarded.', 'achievement');
            } else {
                showEnhancedNotification('🏆 Challenge "' + challenge.title + '" completed! +' + pointsAwarded + ' points earned!', 'achievement');
            }
        }

        function updateChallengeProgress(challengeId, progress) {
            const challenge = challengesData.active.find(c => c.id === challengeId);
            if (!challenge) return;

            challenge.progress = Math.min(progress, challenge.target);
            
            // Check if challenge is completed
            if (challenge.progress >= challenge.target) {
                setTimeout(() => completeChallenge(challengeId), 1000);
            }
            
            renderActiveChallenges();
        }

        function updateChallengesProgress() {
            const completedCount = challengesData.completed.length;
            const totalChallenges = 12; // Total available challenges
            
            document.getElementById('challenges-completed').textContent = `${completedCount}/${totalChallenges}`;
            document.getElementById('challenges-progress-bar').style.width = `${(completedCount / totalChallenges) * 100}%`;
            
            // Update leaderboard
            document.getElementById('user-leaderboard-name').textContent = userData.name || 'You';
            document.getElementById('user-challenges-count').textContent = completedCount;
            document.getElementById('user-weekly-points').textContent = userData.weeklyPoints;
        }

        function getDifficultyColor(difficulty) {
            const colors = {
                'Easy': 'green',
                'Medium': 'yellow',
                'Hard': 'red'
            };
            return colors[difficulty] || 'gray';
        }

        /*
         * Allow users to customise which statistics appear on the dashboard.
         * When a toggle is unchecked, the associated card is hidden.
         */
        function initStatToggles() {
            const toggleMapping = {
                cardio: document.getElementById('toggle-cardio'),
                nutrition: document.getElementById('toggle-nutrition'),
                tobacco: document.getElementById('toggle-tobacco'),
                points: document.getElementById('toggle-points')
            };
            Object.keys(toggleMapping).forEach(key => {
                toggleMapping[key].addEventListener('change', () => {
                    document.querySelectorAll(`[data-stat="${key}"]`).forEach(card => {
                        card.style.display = toggleMapping[key].checked ? '' : 'none';
                    });
                });
            });
        }

        /**
         * Wire up redemption buttons to allow users to exchange points for
         * leave time. Each card defines its hours and cost via data attributes.
         */
        function initRedeem() {
            const buttons = document.querySelectorAll('.redeem-btn');
            buttons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const card = btn.closest('[data-hours]');
                    const hours = parseInt(card.getAttribute('data-hours'));
                    const cost = parseInt(card.getAttribute('data-cost'));
                    if (userData.points >= cost) {
                        userData.points -= cost;
                        userData.leaveTime += hours;
                        showEnhancedNotification(`Redeemed ${hours} hour(s) off!`, 'success');
                        updateDisplay();
                    } else {
                        showEnhancedNotification('Not enough points to redeem this reward', 'error');
                    }
                });
            });
        }

        /*
         * Initialise health assessment features.
         *
         *  - If personalised recommendations exist in localStorage, populate the
         *    "Your Personalized Goals" section and reveal it.
         *  - If the stored health risk assessment date is more than a year ago,
         *    show a reminder prompting the user to complete a new assessment.
         */
        function initHealthAssessmentFeatures() {
            let recs = [];
            try {
                const stored = localStorage.getItem('ahelpRecommendations');
                if (stored) {
                    recs = JSON.parse(stored);
                }
            } catch (err) {
                console.error('Failed to parse stored recommendations:', err);
            }
            if (Array.isArray(recs) && recs.length > 0) {
                const plan = document.getElementById('personalized-plan');
                const list = document.getElementById('personalized-goals-list');
                if (plan && list) {
                    list.innerHTML = '';
                    recs.forEach(item => {
                        const li = document.createElement('li');
                        li.textContent = item;
                        list.appendChild(li);
                    });
                    // Additionally include the user's daily steps goal from settings if available
                    try {
                        const stepsGoal = localStorage.getItem('settingsStepsGoal');
                        if (stepsGoal) {
                            const li = document.createElement('li');
                            li.textContent = `Walk ${stepsGoal} steps daily`;
                            list.appendChild(li);
                        }
                    } catch (err) {
                        console.error('Failed to load steps goal:', err);
                    }
                    plan.classList.remove('hidden');
                }
            }
            const dateStr = localStorage.getItem('ahelpHraDate');
            if (dateStr) {
                const hraDate = new Date(dateStr);
                const now = new Date();
                const diffDays = (now - hraDate) / (1000 * 60 * 60 * 24);
                if (diffDays >= 365) {
                    const reminder = document.getElementById('hra-reminder');
                    if (reminder) {
                        reminder.classList.remove('hidden');
                    }
                }
            }
        }

        // Auto-update challenge progress based on user activities
        function updateChallengeProgressFromActivity() {
            challengesData.active.forEach(challenge => {
                switch(challenge.id) {
                    case 'cardio-streak-7':
                        updateChallengeProgress(challenge.id, userData.cardioStreak);
                        break;
                    case 'tobacco-free-month':
                        updateChallengeProgress(challenge.id, userData.tobaccoStreak);
                        break;
                    case 'water-warrior':
                        // Progress is based on number of days where water goal has been met
                        updateChallengeProgress(challenge.id, userData.waterStreak);
                        break;
                    // Add more challenge progress updates based on user activities
                }
            });
        }

        // Register settings page toggles after DOM has loaded
        document.addEventListener('DOMContentLoaded', () => {
            const darkToggle = document.getElementById('settings-dark-toggle');
            const darkThumb = document.getElementById('settings-dark-thumb');
            if (darkToggle) {
                // Initialize toggle position based on current dark mode state
                if (userData.darkMode) {
                    darkToggle.classList.add('bg-purple-600');
                    darkThumb.classList.add('translate-x-6');
                }
                darkToggle.addEventListener('click', () => {
                    // Trigger the existing dark mode toggle and update thumb appearance
                    document.getElementById('dark-mode-toggle').click();
                    if (userData.darkMode) {
                        darkToggle.classList.add('bg-purple-600');
                        darkThumb.classList.add('translate-x-6');
                    } else {
                        darkToggle.classList.remove('bg-purple-600');
                        darkThumb.classList.remove('translate-x-6');
                    }
                });
            }
            const notifToggle = document.getElementById('settings-notifications-toggle');
            const notifThumb = document.getElementById('settings-notifications-thumb');
            if (notifToggle) {
                // Initialize toggle position based on notificationsEnabled state
                if (notificationsEnabled) {
                    notifToggle.classList.add('bg-orange-500');
                    notifThumb.classList.add('translate-x-6');
                }
                notifToggle.addEventListener('click', () => {
                    notificationsEnabled = !notificationsEnabled;
                    if (notificationsEnabled) {
                        notifToggle.classList.add('bg-orange-500');
                        notifThumb.classList.add('translate-x-6');
                        showEnhancedNotification('🔔 Notifications enabled!', 'info');
                    } else {
                        notifToggle.classList.remove('bg-orange-500');
                        notifThumb.classList.remove('translate-x-6');
                        showEnhancedNotification('🔕 Notifications disabled.', 'info');
                    }
                });
            }
            const settingsLogoutBtn = document.getElementById('settings-logout');
            if (settingsLogoutBtn) {
                settingsLogoutBtn.addEventListener('click', () => {
                    // Use existing logout button to reset state and show login screen
                    document.getElementById('logout-btn').click();
                });
            }
        });

        // Initialize app
        createParticles();
        updateDisplay();
        renderChallenges();

        // Initialize stat toggles after DOM is loaded
        initStatToggles();

        // Hook up redemption buttons
        initRedeem();

        // Initialise personalised plan display and yearly HRA reminders
        initHealthAssessmentFeatures();

        // Back to top functionality
        const backToTopBtn = document.getElementById('back-to-top');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                backToTopBtn.classList.remove('hidden');
            } else {
                backToTopBtn.classList.add('hidden');
            }
        });
        backToTopBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    </script>

    <!-- Footer -->
    <footer class="bg-white py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 md:grid-cols-3 gap-8">
            <div>
                <h3 class="text-lg font-bold mb-3">About AHELP</h3>
                <p class="text-gray-600">AHELP empowers Arkansas state employees to live healthier lifestyles through personalized plans, community support and gamified challenges.</p>
            </div>
            <div>
                <h3 class="text-lg font-bold mb-3">Quick Links</h3>
                <ul class="space-y-2">
                    <li><a href="home.html" class="text-gray-600 hover:text-purple-600">Home</a></li>
                    <li><a href="health-assessment.html" class="text-gray-600 hover:text-purple-600">Assessment</a></li>
                    <li><a href="dashboard.html" class="text-purple-600 font-semibold">Dashboard</a></li>
                    <li><a href="progress.html" class="text-gray-600 hover:text-purple-600">Progress</a></li>
                    <li><a href="challenges.html" class="text-gray-600 hover:text-purple-600">Challenges</a></li>
                    <li><a href="community.html" class="text-gray-600 hover:text-purple-600">Community</a></li>
                    <li><a href="resources.html" class="text-gray-600 hover:text-purple-600">Resources</a></li>
                    <li><a href="profile.html" class="text-gray-600 hover:text-purple-600">Profile</a></li>
                    <li><a href="settings.html" class="text-gray-600 hover:text-purple-600">Settings</a></li>
                    <li><a href="redeem.html" class="text-gray-600 hover:text-purple-600">Redeem</a></li>
                </ul>
            </div>
            <div>
                <h3 class="text-lg font-bold mb-3">Contact Us</h3>
                <p class="text-gray-600">Email: support@ahelp.ar.gov</p>
                <p class="text-gray-600">Phone: 555‑0101</p>
            </div>
        </div>
        <div class="mt-8 text-center text-gray-500">© 2025 Arkansas Shared Administrative Services. All rights reserved.</div>
    </footer>

<!-- Script to handle mobile navigation toggle on the dashboard -->
<script>
    document.getElementById('mobile-menu-button').addEventListener('click', () => {
        document.getElementById('mobile-menu').classList.toggle('hidden');
    });
</script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9685e464f31dbd17',t:'MTc1NDA1NzE0NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
